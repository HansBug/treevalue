

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Apply into Scikit-Learn &mdash; treevalue 1.3.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="treevalue.config" href="../../api_doc/config/index.html" />
    <link rel="prev" title="Apply into Numpy" href="../numpy/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> treevalue
          

          
          </a>

          
            
            
              <div class="version">
                1.3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/quick_start/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/main_idea/index.html">Main Idea</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/basic_usage/index.html">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/advanced_usage/index.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/cli_usage/index.html">CLI Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/plugins/index.html">Plugins</a></li>
</ul>
<p><span class="caption-text">Best Practice</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../numpy/index.html">Apply into Numpy</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Apply into Scikit-Learn</a></li>
</ul>
<p><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/config/index.html">treevalue.config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/tree/index.html">treevalue.tree</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/utils/index.html">treevalue.utils</a></li>
</ul>
<p><span class="caption-text">Contributor Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/architecture/index.html">Architecture</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">treevalue</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Apply into Scikit-Learn</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/best_practice/sklearn/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
    
    
  <section id="apply-into-scikit-learn">
<h1>Apply into Scikit-Learn<a class="headerlink" href="#apply-into-scikit-learn" title="Permalink to this headline">¶</a></h1>
<p>Actually, <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> can be used in practice with not only <code class="docutils literal notranslate"><span class="pre">numpy</span></code> or <code class="docutils literal notranslate"><span class="pre">torch</span></code> library, such as <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>.
In the following part, a demo of PCA to tree-structured arrays will be shown.</p>
<p>In the field of traditional machine learning, PCA (Principal Component Analysis) is often used to preprocess data,
by normalizing the data range, and trying to reduce the dimensionality of the data, so as to reduce the complexity
of the input data and improve machine learning’s efficiency and quality. Just as the following image</p>
<figure class="align-default" id="figure-1">
<img alt="PCA Principle" src="../../_images/heading_of_pca.jpg" />
<figcaption>
<p><span class="caption-text">PCA in a nutshell. Source: Lavrenko and Sutton 2011, slide 13.</span><a class="headerlink" href="#figure-1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>In the scikit-learn library, the PCA class is provided to support this function, and the function <code class="docutils literal notranslate"><span class="pre">fit_transform</span></code>
can be used to simplify the data. For a set of <code class="docutils literal notranslate"><span class="pre">np.array</span></code> format data that presents a tree structure,
we can implement the operation support for the tree structure by quickly wrapping the function <code class="docutils literal notranslate"><span class="pre">fit_transform</span></code>.
The specific code is as follows</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span>

<span class="n">fit_transform</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="o">.</span><span class="n">func</span><span class="p">()(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">PCA</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
        <span class="p">}</span>
    <span class="p">})</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original int data:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">pdata</span> <span class="o">=</span> <span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fit transformed data:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pdata</span><span class="p">)</span>
</pre></div></td></tr></table></div>
</div>
<p>The output should be</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span>Original int data:
&lt;FastTreeValue 0x7f4e381b5b20&gt;
├── &#39;a&#39; --&gt; array([[-4,  5, 10],
│                  [-4, 11, 14],
│                  [-2, -3, -2],
│                  [ 0,  5,  6]])
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f4e3846cee0&gt;
    └── &#39;c&#39; --&gt; array([[ -3,  -1, -15,  -5],
                       [  4,  -8, -12,  -5],
                       [ -9,  -3,  -3, -10],
                       [-12, -12,  -3,  -6],
                       [  3,  -2,  -8,  -1]])

Fit transformed data:
&lt;FastTreeValue 0x7f4e264baa60&gt;
├── &#39;a&#39; --&gt; array([[-2.77468681, -1.81554105,  0.71057991],
│                  [-9.64589606, -0.11503583, -0.66592485],
│                  [11.69897785, -0.68689435, -0.40260834],
│                  [ 0.72160502,  2.61747123,  0.35795327]])
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f4e37557e80&gt;
    └── &#39;c&#39; --&gt; array([[-5.05694632,  4.66046695, -3.93722329, -1.18558614],
                       [-7.0140145 , -4.46871261, -1.39276642,  2.46868587],
                       [ 7.55147672,  4.17021335,  2.23493576,  2.23373727],
                       [11.33769203, -3.80085568, -1.40194398, -1.6262806 ],
                       [-6.81820793, -0.561112  ,  4.49699793, -1.89055639]])
</pre></div></td></tr></table></div>
</div>
<p>For further information, see the links below:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html?highlight=pca#sklearn.decomposition.PCA">Official documentation of PCA in scikit-learn</a></p></li>
<li><p><a class="reference external" href="https://devopedia.org/principal-component-analysis">Details of PCA</a></p></li>
</ul>
</section>



           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../api_doc/config/index.html" class="btn btn-neutral float-right" title="treevalue.config" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../numpy/index.html" class="btn btn-neutral float-left" title="Apply into Numpy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2024, HansBug, DI-engine&#39;s Contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: v1.3.1
    <span class="fa fa-caret-down"></span>
  </span>
        <div class="rst-other-versions">
                <dl>
                    <dt>Tags</dt>
                        <dd><a href="../../../v0.0.1/index.html">v0.0.1</a></dd>
                        <dd><a href="../../../v0.1.0/index.html">v0.1.0</a></dd>
                        <dd><a href="../../../v1.0.0/index.html">v1.0.0</a></dd>
                        <dd><a href="../../../v1.1.0/index.html">v1.1.0</a></dd>
                        <dd><a href="../../../v1.2.0/best_practice/sklearn/index.html">v1.2.0</a></dd>
                        <dd><a href="../../../v1.2.1/best_practice/sklearn/index.html">v1.2.1</a></dd>
                        <dd><a href="../../../v1.2.2/best_practice/sklearn/index.html">v1.2.2</a></dd>
                        <dd><a href="../../../v1.3.0/best_practice/sklearn/index.html">v1.3.0</a></dd>
                        <dd><a href="index.html">v1.3.1</a></dd>
                        <dd><a href="../../../v1.4.0/best_practice/sklearn/index.html">v1.4.0</a></dd>
                        <dd><a href="../../../v1.4.1/best_practice/sklearn/index.html">v1.4.1</a></dd>
                        <dd><a href="../../../v1.4.10/best_practice/sklearn/index.html">v1.4.10</a></dd>
                        <dd><a href="../../../v1.4.11/best_practice/sklearn/index.html">v1.4.11</a></dd>
                        <dd><a href="../../../v1.4.12/best_practice/sklearn/index.html">v1.4.12</a></dd>
                        <dd><a href="../../../v1.4.2/best_practice/sklearn/index.html">v1.4.2</a></dd>
                        <dd><a href="../../../v1.4.3/best_practice/sklearn/index.html">v1.4.3</a></dd>
                        <dd><a href="../../../v1.4.4/best_practice/sklearn/index.html">v1.4.4</a></dd>
                        <dd><a href="../../../v1.4.5/best_practice/sklearn/index.html">v1.4.5</a></dd>
                        <dd><a href="../../../v1.4.6/best_practice/sklearn/index.html">v1.4.6</a></dd>
                        <dd><a href="../../../v1.4.7/best_practice/sklearn/index.html">v1.4.7</a></dd>
                        <dd><a href="../../../v1.4.9/best_practice/sklearn/index.html">v1.4.9</a></dd>
                        <dd><a href="../../../v1.5.0/best_practice/sklearn/index.html">v1.5.0</a></dd>
                </dl>
                <dl>
                    <dt>Branches</dt>
                        <dd><a href="../../../dependabot/github_actions/dot-github/workflows/actions/download-artifact-4.1.7/best_practice/sklearn/index.html">dependabot/github_actions/dot-github/workflows/actions/download-artifact-4.1.7</a></dd>
                        <dd><a href="../../../dev/torch2/best_practice/sklearn/index.html">dev/torch2</a></dd>
                        <dd><a href="../../../dev/wrap/best_practice/sklearn/index.html">dev/wrap</a></dd>
                        <dd><a href="../../../doc/readme/best_practice/sklearn/index.html">doc/readme</a></dd>
                        <dd><a href="../../../main/best_practice/sklearn/index.html">main</a></dd>
                        <dd><a href="../../../refactor/color/index.html">refactor/color</a></dd>
                        <dd><a href="../../../run/paper/best_practice/sklearn/index.html">run/paper</a></dd>
                </dl>
        </div>
    </div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>