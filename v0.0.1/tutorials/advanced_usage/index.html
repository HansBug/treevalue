

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Advanced Usage &mdash; treevalue 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Apply into Numpy" href="../../best_practice/numpy/index.html" />
    <link rel="prev" title="Basic Usage" href="../basic_usage/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> treevalue
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main_idea/index.html">Main Idea</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic_usage/index.html">Basic Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#function-modes">Function Modes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#strict-mode">Strict Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#left-mode">Left Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inner-mode">Inner Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outer-mode">Outer Mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#inheriting-on-trees">Inheriting on Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="#process-missing-values">Process Missing Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functional-utilities">Functional Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mapping">Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#filter">Filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mask">Mask</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reduce">Reduce</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#structural-utilities">Structural Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#union">Union</a></li>
<li class="toctree-l3"><a class="reference internal" href="#subside">Subside</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rise">Rise</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tree-utilities">Tree Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jsonify">Jsonify</a></li>
<li class="toctree-l3"><a class="reference internal" href="#view">View</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clone">Clone</a></li>
<li class="toctree-l3"><a class="reference internal" href="#typetrans">Typetrans</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#object-oriented-usage">Object Oriented Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#diy-treevalue-class">DIY TreeValue Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#diy-treevalue-utility-class">DIY TreeValue Utility Class</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Best Practice</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../best_practice/numpy/index.html">Apply into Numpy</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/config/index.html">treevalue.config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/tree/index.html">treevalue.tree</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/utils/index.html">treevalue.utils</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributor Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/architecture/index.html">Architecture</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">treevalue</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Advanced Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/advanced_usage/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
    
    
  <div class="section" id="advanced-usage">
<h1>Advanced Usage<a class="headerlink" href="#advanced-usage" title="Permalink to this headline">¶</a></h1>
<p>In this part, Some of the advanced usages of <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> will be introduced one by one with sample code and graph to explain them.</p>
<p>For further information or usage of <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> and <code class="docutils literal notranslate"><span class="pre">FastTreeValue</span></code>, you may take a look at the following pages:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> and its utilities: <a class="reference internal" href="../../api_doc/tree/tree.html"><span class="doc">treevalue.tree.tree</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">func_treelize</span></code> and other wrappers: <a class="reference internal" href="../../api_doc/tree/func.html"><span class="doc">treevalue.tree.func</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FastTreeValue</span></code> and its operators, methods: <a class="reference internal" href="../../api_doc/tree/general.html"><span class="doc">treevalue.tree.general</span></a>.</p></li>
</ul>
<div class="section" id="function-modes">
<span id="tutorials-advancedusage-modes"></span><h2>Function Modes<a class="headerlink" href="#function-modes" title="Permalink to this headline">¶</a></h2>
<p>In the basic usage description in <a class="reference internal" href="../basic_usage/index.html#tutorials-basicusage-func"><span class="std std-ref">Make function tree supported</span></a>, we can see that a common function which only support the calculation of the common values can be wrapped to support the tree-based calculation painlessly.</p>
<p>Here is the documentation of function <cite>treevalue.tree.func.func_treelize</cite>.</p>
<dl class="py function">
<dt>
<code class="sig-prename descclassname">treevalue.tree.func.</code><code class="sig-name descname">func_treelize</code><span class="sig-paren">(</span><em class="sig-param">mode: Union[str</em>, <em class="sig-param">treevalue.tree.func.func.TreeMode] = 'strict'</em>, <em class="sig-param">return_type: Optional[Type[_ClassType]] = &lt;class 'treevalue.tree.tree.tree.TreeValue'&gt;</em>, <em class="sig-param">inherit: bool = True</em>, <em class="sig-param">missing: Union[Any</em>, <em class="sig-param">Callable] = &lt;SingletonMark 'missing_not_allow'&gt;</em>, <em class="sig-param">subside: Optional[Union[Mapping</em>, <em class="sig-param">bool]] = None</em>, <em class="sig-param">rise: Optional[Union[Mapping</em>, <em class="sig-param">bool]] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/treevalue/tree/func/func.html#func_treelize"><span class="viewcode-link">[source]</span></a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>Wrap a common function to tree-supported function.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>mode (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[str,</span> <span class="pre">TreeMode]</span></code>): Mode of the wrapping (string or TreeMode both okay), default is <cite>strict</cite>.</p></li>
<li><p>return_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional[Type[_ClassType]]</span></code>): Return type of the wrapped function, default is <cite>TreeValue</cite>.</p></li>
<li><p>inherit (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Allow inherit in wrapped function, default is <cite>True</cite>.</p></li>
<li><p>missing (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[Any,</span> <span class="pre">Callable]</span></code>): Missing value or lambda generator of when missing,             default is <cite>MISSING_NOT_ALLOW</cite>, which means raise <cite>KeyError</cite> when missing detected.</p></li>
<li><p>subside (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[Mapping,</span> <span class="pre">bool,</span> <span class="pre">None]</span></code>): Subside enabled to function’s arguments or not,             and subside configuration, default is <cite>None</cite> which means do not use subside.             When subside is <cite>True</cite>, it will use all the default arguments in <cite>subside</cite> function.</p></li>
<li><p>rise (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[Mapping,</span> <span class="pre">bool,</span> <span class="pre">None]</span></code>): Rise enabled to function’s return value or not,             and rise configuration, default is <cite>None</cite> which means do not use rise.             When rise is <cite>True</cite>, it will use all the default arguments in <cite>rise</cite> function.             (Not recommend to use auto mode when your return structure is not so strict.)</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>decorator (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Callable</span></code>): Wrapper for tree-supported function.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@func_treelize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">ssum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>  <span class="c1"># the a and b will be integers, not TreeValue</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">33</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>    <span class="c1"># 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssum</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>  <span class="c1"># TreeValue({&#39;a&#39;: 12, &#39;b&#39;: 24, &#39;x&#39;: {&#39;c&#39;: 36, &#39;d&#39;: 9}})</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<p>In the arguments listed above, 3 of them are key arguments:</p>
<ul class="simple">
<li><p><strong>mode</strong>, Tree process mode of the calculation. Will be introduced in this section.</p></li>
<li><p><strong>inherit</strong>, Inheriting mode of the calculation on the tree. Will be introduced in <a class="reference internal" href="#tutorials-advancedusage-inherit"><span class="std std-ref">Inheriting on Trees</span></a>.</p></li>
<li><p><strong>missing</strong>, Missing processor of the calculation on the tree. Will be introduced in <a class="reference internal" href="#tutorials-advancedusage-missing"><span class="std std-ref">Process Missing Values</span></a>.</p></li>
</ul>
<p>The mode argument is the most important argument in function <code class="docutils literal notranslate"><span class="pre">func_treelize</span></code>. For it depends the basic logic of the graph calculation.</p>
<p>The type of <code class="docutils literal notranslate"><span class="pre">mode</span></code> argument is <code class="docutils literal notranslate"><span class="pre">TreeMode</span></code>, which documentation is like this.</p>
<dl class="py enum">
<dt>
<em class="property">enum </em><code class="sig-prename descclassname">treevalue.tree.func.</code><code class="sig-name descname">TreeMode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/treevalue/tree/func/func.html#TreeMode"><span class="viewcode-link">[source]</span></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Four mode of the tree calculation</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Member Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
<p>Valid values are as follows:</p>
<dl class="py attribute">
<dt>
<code class="sig-name descname">STRICT</code><em class="property"> = &lt;TreeMode.STRICT: 1&gt;</em></dt>
<dd><p>Strict mode, which means the keys should be one to one in every trees.</p>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">LEFT</code><em class="property"> = &lt;TreeMode.LEFT: 2&gt;</em></dt>
<dd><p>Left mode, the keys of the result is relied on the left value.</p>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">INNER</code><em class="property"> = &lt;TreeMode.INNER: 3&gt;</em></dt>
<dd><p>Inner mode, the keys of the result is relied on the intersection of the trees’ key set.</p>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">OUTER</code><em class="property"> = &lt;TreeMode.OUTER: 4&gt;</em></dt>
<dd><p>Outer mode, the keys of the result is relied on the union of the trees’ key set.</p>
</dd></dl>

</dd></dl>

<p>In this part, all of the 4 modes will be introduced with details and samples one by one.</p>
<div class="section" id="strict-mode">
<h3>Strict Mode<a class="headerlink" href="#strict-mode" title="Permalink to this headline">¶</a></h3>
<p>Strict mode is the most frequently-used mode in real cases. It is also the default value of the <code class="docutils literal notranslate"><span class="pre">mode</span></code> argument in the treelize functions.</p>
<p>To be simple, strict mode need the keys of a node in the tree be strictly mapped one by one, missing or overage of the keys are both forbidden in strict mode, which means <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> will be raised.</p>
<p>For example, in the trees in <code class="docutils literal notranslate"><span class="pre">strict_demo_1</span></code>, if we need to added <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code> together, <code class="docutils literal notranslate"><span class="pre">t3</span></code> will be the result. Because all the keys (<code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">x</span></code> of the root nodes, and <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code> of the <code class="docutils literal notranslate"><span class="pre">x</span></code> node) can be mapped one by one.</p>
<img alt="../../_images/strict_demo_1.gv.svg" class="align-center" src="../../_images/strict_demo_1.gv.svg" /><p>In another situation, when the keys are not so regular like that in <code class="docutils literal notranslate"><span class="pre">strict_demo_1</span></code>, like the trees in <code class="docutils literal notranslate"><span class="pre">strict_demo_2</span></code>. If we try to add <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code> in strict mode, <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> will be raised due to the missing of key <code class="docutils literal notranslate"><span class="pre">a</span></code> in <code class="docutils literal notranslate"><span class="pre">t1</span></code> and key <code class="docutils literal notranslate"><span class="pre">f</span></code> in <cite>t2.x</cite>.</p>
<img alt="../../_images/strict_demo_2.gv.svg" class="align-center" src="../../_images/strict_demo_2.gv.svg" /><p>Here is a real code example of strict mode.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">func_treelize</span>


<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;strict&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">}})</span>
    <span class="n">t4</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t4, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t4</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>The stdout and stderr should like below, a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> is raised at the second <code class="docutils literal notranslate"><span class="pre">print</span></code> statement.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>plus(t1, t2): &lt;TreeValue 0x7f7485d40710 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 12
├── &#39;b&#39; --&gt; 24
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f7485d40290 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    ├── &#39;d&#39; --&gt; 52
    └── &#39;e&#39; --&gt; 59
</pre></div>
</td></tr></table></div>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/docs/source/tutorials/advanced_usage/strict_demo.demox.py&quot;, line 15, in &lt;module&gt;
    print(&#39;plus(t4, t2):&#39;, plus(t4, t2))
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 148, in _new_func
    _result = _recursion(*args, **kwargs)
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 138, in _recursion
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/strict.py&quot;, line 15, in get_key_set
    a2=repr(index), ks2=repr(keyset),
KeyError: &quot;Argument keys not match in strict mode, key set of argument 1 is (&#39;b&#39;, &#39;x&#39;) but 2 in (&#39;a&#39;, &#39;b&#39;, &#39;x&#39;).&quot;
</pre></div>
</td></tr></table></div>
<div class="admonition note" id="tutorials-advancedusage-how-works">
<p class="admonition-title">Note</p>
<p>How does the treelized function work?</p>
<p>Here is another example which show the actual calculation process of the wrapped function.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">func_treelize</span>


<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;strict&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current a and b:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">a</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]),</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">]),</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mf">4.8</span><span class="p">,</span>
            <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]),</span>
        <span class="p">}</span>
    <span class="p">})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]),</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mf">4.8</span><span class="p">,</span>
            <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]),</span>
        <span class="p">}</span>
    <span class="p">})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t3):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t3</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>In this code, once the original function <code class="docutils literal notranslate"><span class="pre">plus</span></code> is called, the actual value of argument <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> will be printed to stdout.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">plus(t1,</span> <span class="pre">t2)</span></code>, all the calculation can be carried on because add operator between primitive <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> is supported, so no error occurs and the result of <code class="docutils literal notranslate"><span class="pre">+</span></code> between <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> will be one of the values of the result tree.</p>
<p>But in <code class="docutils literal notranslate"><span class="pre">plus(t1,</span> <span class="pre">t3)</span></code>, when get the result of <code class="docutils literal notranslate"><span class="pre">plus(t1,</span> <span class="pre">t3).b</span></code>, it will try to add <code class="docutils literal notranslate"><span class="pre">t1.b</span></code> and <code class="docutils literal notranslate"><span class="pre">t2.b</span></code> together, but there is no implement of operator <code class="docutils literal notranslate"><span class="pre">+</span></code> between primitive <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">list</span></code> objects, so <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> will be raised when do this calculation.</p>
<p>The complete stdout and stderr should be like this.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>Current a and b: &lt;class &#39;int&#39;&gt; 11 &lt;class &#39;numpy.ndarray&#39;&gt; [1 3 5 7]
Current a and b: &lt;class &#39;int&#39;&gt; 22 &lt;class &#39;numpy.ndarray&#39;&gt; [ 2  5  8 11]
Current a and b: &lt;class &#39;int&#39;&gt; 30 &lt;class &#39;int&#39;&gt; 3
Current a and b: &lt;class &#39;int&#39;&gt; 48 &lt;class &#39;float&#39;&gt; 4.8
Current a and b: &lt;class &#39;int&#39;&gt; 54 &lt;class &#39;numpy.ndarray&#39;&gt; [[2 3]
 [5 6]]
plus(t1, t2): &lt;TreeValue 0x7f1d5e118550 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; array([12, 14, 16, 18])
├── &#39;b&#39; --&gt; array([24, 27, 30, 33])
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f1d5e118110 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    ├── &#39;d&#39; --&gt; 52.8
    └── &#39;e&#39; --&gt; array([[56, 57],
       [59, 60]])


Current a and b: &lt;class &#39;int&#39;&gt; 11 &lt;class &#39;numpy.ndarray&#39;&gt; [1 3 5 7]
Current a and b: &lt;class &#39;int&#39;&gt; 22 &lt;class &#39;list&#39;&gt; [2, 5, 8, 11]
</pre></div>
</td></tr></table></div>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/docs/source/tutorials/advanced_usage/strict_demo_show.demox.py&quot;, line 35, in &lt;module&gt;
    print(&#39;plus(t1, t3):&#39;, plus(t1, t3))
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 148, in _new_func
    _result = _recursion(*args, **kwargs)
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 138, in _recursion
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 138, in &lt;dictcomp&gt;
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 129, in _recursion
    return func(*args, **kwargs)
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/docs/source/tutorials/advanced_usage/strict_demo_show.demox.py&quot;, line 9, in plus
    return a + b
TypeError: unsupported operand type(s) for +: &#39;int&#39; and &#39;list&#39;
</pre></div>
</td></tr></table></div>
</div>
<p>In strict mode, missing or overage of keys are not tolerated at all. So in some of the cases, especially when you can not suppose that all the trees involved in calculation has exactly the same structure. Based on this demand, left mode, inner mode and outer mode is designed, and they will be introduced with details and examples in the next 3 sections.</p>
</div>
<div class="section" id="left-mode">
<h3>Left Mode<a class="headerlink" href="#left-mode" title="Permalink to this headline">¶</a></h3>
<p>In left mode, the result tree’s key set will be aligned to the first tree from the left.</p>
<p>In the trees in <code class="docutils literal notranslate"><span class="pre">left_demo_1</span></code>, <code class="docutils literal notranslate"><span class="pre">t3</span></code> is the plus result of <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code>. We can see that <cite>t2.a</cite> is ignored because of <cite>t1.a</cite> ‘s non-existence. Finally no error will be raised, the calculation will be processed properly with the tree structure of <code class="docutils literal notranslate"><span class="pre">t1</span></code>.</p>
<img alt="../../_images/left_demo_1.gv.svg" class="align-center" src="../../_images/left_demo_1.gv.svg" /><p>But in the <code class="docutils literal notranslate"><span class="pre">left_demo_2</span></code> (actually it is exactly the same as <code class="docutils literal notranslate"><span class="pre">strict_demo_2</span></code>), <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> will be raised because <cite>t2.x.f`</cite> not found in tree <code class="docutils literal notranslate"><span class="pre">t2`,</span> <span class="pre">so</span> <span class="pre">the</span> <span class="pre">result</span> <span class="pre">\</span>
<span class="pre">can</span> <span class="pre">not</span> <span class="pre">be</span> <span class="pre">aligned</span> <span class="pre">to</span> <span class="pre">tree</span> <span class="pre">``t1</span></code>, calculation failed.</p>
<img alt="../../_images/left_demo_2.gv.svg" class="align-center" src="../../_images/left_demo_2.gv.svg" /><p>When you decorate a function as left mode, the decorated function will try to find the first tree from left. If there is no less than 1 positional arguments detected, the first positional argument will be used as the left tree. Otherwise, the tree with the smallest lexicographic key will be assigned as the left tree. Obviously, As least 1 positional or key-word-based argument should be in the arguments.</p>
<p>Here is a real code example of left mode.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">func_treelize</span>


<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">}})</span>
    <span class="n">t4</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t4, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t4</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>The stdout and stderr should like below, a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> is raised at the second <code class="docutils literal notranslate"><span class="pre">print</span></code> statement.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>plus(t1, t2): &lt;TreeValue 0x7f707d3d5790 keys: [&#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;b&#39; --&gt; 24
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f707d3d5310 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    ├── &#39;d&#39; --&gt; 52
    └── &#39;e&#39; --&gt; 59
</pre></div>
</td></tr></table></div>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/docs/source/tutorials/advanced_usage/left_demo.demox.py&quot;, line 15, in &lt;module&gt;
    print(&#39;plus(t4, t2):&#39;, plus(t4, t2))
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 148, in _new_func
    _result = _recursion(*args, **kwargs)
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 138, in _recursion
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 138, in &lt;dictcomp&gt;
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 138, in _recursion
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 138, in &lt;dictcomp&gt;
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 136, in &lt;genexpr&gt;
    *(item(key) for item in pargs),
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 114, in _get_from_key
    key=repr(key), item=repr(item),
KeyError: &quot;Missing is off, key &#39;f&#39; not found in &lt;FastTreeValue 0x7f707d4519d0 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;.&quot;
</pre></div>
</td></tr></table></div>
<p>In the code example above, the result is aligned to tree <code class="docutils literal notranslate"><span class="pre">a</span></code> in wrapped function <code class="docutils literal notranslate"><span class="pre">plus</span></code>. So the first plus calculation will get the proper result, but the second one will fail.</p>
</div>
<div class="section" id="inner-mode">
<h3>Inner Mode<a class="headerlink" href="#inner-mode" title="Permalink to this headline">¶</a></h3>
<p>In inner mode, the result tree’s key set will be aligned to the intersection set of all the tree’s key set in arguments.</p>
<p>In the trees in <code class="docutils literal notranslate"><span class="pre">inner_demo_1</span></code>, <code class="docutils literal notranslate"><span class="pre">t3</span></code> is the plus result of <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code>. We can see that <code class="docutils literal notranslate"><span class="pre">t2.a</span></code> and <code class="docutils literal notranslate"><span class="pre">t1.x.f</span></code> is ignored because of <code class="docutils literal notranslate"><span class="pre">t1.a</span></code>  and <code class="docutils literal notranslate"><span class="pre">t2.x.f</span></code>’s non-existence. Finally no error will be raised, the calculation will be processed properly with the tree structure of the intersection between tree <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code>.</p>
<img alt="../../_images/inner_demo_1.gv.svg" class="align-center" src="../../_images/inner_demo_1.gv.svg" /><div class="admonition note">
<p class="admonition-title">Note</p>
<p>In most cases of inner mode, the calculation will be processed properly because of the intersection operation on the key set and key missing or overage are both avoided completely.</p>
<p>But the shortage of inner mode is the loss of some information, for keys and its value or subtrees will be directly ignored without any warning. So <strong>before using inner mode, please confirm that you know its running logic and the missing of some nodes</strong>.</p>
</div>
<p>Here is a real code example of inner mode.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">func_treelize</span>


<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">}})</span>
    <span class="n">t4</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t4, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t4</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>The stdout (no stderr content in this case) should like below, no errors occurred with exit code 0.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>plus(t1, t2): &lt;TreeValue 0x7f2783709710 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 12
├── &#39;b&#39; --&gt; 24
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f2783709290 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    ├── &#39;d&#39; --&gt; 52
    └── &#39;e&#39; --&gt; 59

plus(t4, t2): &lt;TreeValue 0x7f2783709c90 keys: [&#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;b&#39; --&gt; 24
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f2783709950 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    ├── &#39;d&#39; --&gt; 52
    └── &#39;e&#39; --&gt; 59
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="outer-mode">
<h3>Outer Mode<a class="headerlink" href="#outer-mode" title="Permalink to this headline">¶</a></h3>
<p>In outer mode, the result tree’s key set will be aligned to the union set of the tree’s key set in arguments.</p>
<p>In the trees in <code class="docutils literal notranslate"><span class="pre">outer_demo_1</span></code>, <code class="docutils literal notranslate"><span class="pre">t3</span></code> is the plus result of <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code>, with the missing value of <code class="docutils literal notranslate"><span class="pre">0</span></code>. We can see that all the values in tree <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code> are involved in this calculation, and because of the missing of <code class="docutils literal notranslate"><span class="pre">t1.a</span></code> and <code class="docutils literal notranslate"><span class="pre">t2.x.f</span></code> they will be actually treated as <code class="docutils literal notranslate"><span class="pre">0</span></code> in calculation process. Finally no error will be raised, and sum of the tree nodes’ value will form the result tree <code class="docutils literal notranslate"><span class="pre">t3</span></code>.</p>
<img alt="../../_images/outer_demo_1.gv.svg" class="align-center" src="../../_images/outer_demo_1.gv.svg" /><div class="admonition note">
<p class="admonition-title">Note</p>
<p>In outer mode, it is strongly recommended to set the value of argument <code class="docutils literal notranslate"><span class="pre">missing</span></code>. When <code class="docutils literal notranslate"><span class="pre">missing</span></code>’s value is not set and there are key missing in some of the argument trees, <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> will be raised
due to this missing and value of <code class="docutils literal notranslate"><span class="pre">missing</span></code>.</p>
<p>For further information and examples of <code class="docutils literal notranslate"><span class="pre">missing</span></code> argument, take a look at
<a class="reference internal" href="#tutorials-advancedusage-missing"><span class="std std-ref">Process Missing Values</span></a>.</p>
</div>
<p>Here is a real code example of inner mode.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">func_treelize</span>


<span class="c1"># missing value is very important when use outer mode</span>
<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>The stdout (no stderr content in this case) should like below, no errors occurred with exit code 0.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>plus(t1, t2): &lt;TreeValue 0x7fd66403e550 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 11
├── &#39;b&#39; --&gt; 24
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fd66403e090 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    ├── &#39;d&#39; --&gt; 52
    ├── &#39;e&#39; --&gt; 59
    └── &#39;f&#39; --&gt; 6
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="inheriting-on-trees">
<span id="tutorials-advancedusage-inherit"></span><h2>Inheriting on Trees<a class="headerlink" href="#inheriting-on-trees" title="Permalink to this headline">¶</a></h2>
<p>Inheriting is another important feature of treelize functions. It will be introduced in this section with necessary examples.</p>
<p>In some cases, we need to calculation between values with different dimensions, such as in <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, you can add primitive integer with a <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> object, like this</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">ar1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ar1 + 9:&#39;</span><span class="p">,</span> <span class="n">ar1</span> <span class="o">+</span> <span class="mi">9</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The result will be like below, result of <code class="docutils literal notranslate"><span class="pre">ar1</span> <span class="pre">+</span> <span class="pre">9</span></code> is actually the same as the result of expression <code class="docutils literal notranslate"><span class="pre">ar1</span> <span class="pre">+</span> <span class="pre">np.array([[9,</span> <span class="pre">9],</span> <span class="pre">[9,</span> <span class="pre">9]])</span></code>.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>ar1 + 9:
[[10 11]
 [12 13]]
</pre></div>
</td></tr></table></div>
<p>In treelize functions, you can achieve this processing way by use the <code class="docutils literal notranslate"><span class="pre">inherit</span></code> argument. Considering this situation can be find almost anywhere, so the default value of <code class="docutils literal notranslate"><span class="pre">inherit</span></code> argument is <code class="docutils literal notranslate"><span class="pre">True</span></code>, which means the inheriting option is on by default.</p>
<p>We can see the example in <code class="docutils literal notranslate"><span class="pre">inherit_demo_1</span></code>, the tree <code class="docutils literal notranslate"><span class="pre">t1</span></code> and tree <code class="docutils literal notranslate"><span class="pre">t2</span></code> have different structures, and cannot be processed by any modes in <a class="reference internal" href="#tutorials-advancedusage-modes"><span class="std std-ref">Function Modes</span></a>, because <code class="docutils literal notranslate"><span class="pre">t1.x</span></code> is a primitive integer value but <code class="docutils literal notranslate"><span class="pre">t2.x</span></code> is a subtree node, their types are structurally different.</p>
<img alt="../../_images/inherit_demo_1.gv.svg" class="align-center" src="../../_images/inherit_demo_1.gv.svg" /><p>But when inheriting is enabled, this adding operation can still be carried on, for the value of <code class="docutils literal notranslate"><span class="pre">t1.x</span></code> (is <code class="docutils literal notranslate"><span class="pre">9</span></code> in <code class="docutils literal notranslate"><span class="pre">inherit_demo_1</span></code>) will be applied to the whole subtree <code class="docutils literal notranslate"><span class="pre">t2.x</span></code>, like the result tree <code class="docutils literal notranslate"><span class="pre">t3</span></code> shows. The result of tree <code class="docutils literal notranslate"><span class="pre">t3.x</span></code> can be considered as the sum of primitive integer <code class="docutils literal notranslate"><span class="pre">9</span></code> and subtree <code class="docutils literal notranslate"><span class="pre">t2.x</span></code>.</p>
<p>Based on the structural properties above, in the example of <code class="docutils literal notranslate"><span class="pre">inherit_demo_2</span></code>, a primitive value can be directly added with a complete tree, like the result tree <code class="docutils literal notranslate"><span class="pre">t2</span> <span class="pre">=</span> <span class="pre">t1</span> <span class="pre">+</span> <span class="pre">5</span></code> shows.</p>
<img alt="../../_images/inherit_demo_2.gv.svg" class="align-center" src="../../_images/inherit_demo_2.gv.svg" /><p>When inheriting is disabled, all the cases with primitive value and tree node at the same path position will cause <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>. For example, when inheriting is disabled, <code class="docutils literal notranslate"><span class="pre">inherit_demo_1</span></code> and <code class="docutils literal notranslate"><span class="pre">inherit_demo_2</span></code> will failed, but <code class="docutils literal notranslate"><span class="pre">strict_demo_1</span></code> will still success because no primitive value appears at the same path position of tree node.</p>
<img alt="../../_images/strict_demo_1.gv.svg" class="align-center" src="../../_images/strict_demo_1.gv.svg" /><p>Here is a real code example of inheriting.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">func_treelize</span>


<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;strict&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;strict&#39;</span><span class="p">,</span> <span class="n">inherit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plusx</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t2, 5):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plusx(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plusx</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>The stdout and stderr should be like below, the the calculation of <code class="docutils literal notranslate"><span class="pre">plus</span></code> function and the first calculation of <code class="docutils literal notranslate"><span class="pre">plusx</span></code> function will be processed properly, but the last one will failed due to the disablement of inheriting.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>plus(t1, t2): &lt;TreeValue 0x7f1749688950 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 12
├── &#39;b&#39; --&gt; 24
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f17496883d0 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; 39
    ├── &#39;d&#39; --&gt; 57
    └── &#39;e&#39; --&gt; 63

plus(t2, 5): &lt;TreeValue 0x7f1749688e10 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 16
├── &#39;b&#39; --&gt; 27
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f1749688d10 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; 35
    ├── &#39;d&#39; --&gt; 53
    └── &#39;e&#39; --&gt; 59
</pre></div>
</td></tr></table></div>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/docs/source/tutorials/advanced_usage/inherit_demo.demox.py&quot;, line 22, in &lt;module&gt;
    print(&#39;plusx(t1, t2):&#39;, plusx(t1, t2))
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 148, in _new_func
    _result = _recursion(*args, **kwargs)
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 138, in _recursion
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 138, in &lt;dictcomp&gt;
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 131, in _recursion
    pargs = [_value_wrap(item, index) for index, item in enumerate(args)]
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 131, in &lt;listcomp&gt;
    pargs = [_value_wrap(item, index) for index, item in enumerate(args)]
  File &quot;/tmp/tmp3pwtz737/6675a5649d7e854f9c348a59e3535443ae8d8282/treevalue/tree/func/func.py&quot;, line 122, in _value_wrap
    type=repr(type(item).__name__), index=repr(index),
TypeError: Inherit is off, tree value expected but &#39;int&#39; found in args 0.
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In most cases, disablement of inheriting is not recommended because it will cause some errors. Disable inheriting can increase the structural strictness of calculation, but all the cross-dimensional tree operation will be forbidden as well.</p>
<p>So before disabling inheriting, make sure you know well about what you are going to do.</p>
</div>
</div>
<div class="section" id="process-missing-values">
<span id="tutorials-advancedusage-missing"></span><h2>Process Missing Values<a class="headerlink" href="#process-missing-values" title="Permalink to this headline">¶</a></h2>
<p>In some cases of left mode and outer mode, some of keys in result tree can not find the node nor value at the corresponding path position in some of the argument trees. In order the make these cases be processable, missing value can be used by setting value or lambda expression in <code class="docutils literal notranslate"><span class="pre">missing</span></code> argument.</p>
<p>Just like the example <code class="docutils literal notranslate"><span class="pre">outer_demo_1</span></code> mentioned forwards, when <code class="docutils literal notranslate"><span class="pre">t1.a</span></code> and <code class="docutils literal notranslate"><span class="pre">t2.x.f</span></code> not found in trees, the given missing value <code class="docutils literal notranslate"><span class="pre">0</span></code> will be used instead.</p>
<img alt="../../_images/outer_demo_1.gv.svg" class="align-center" src="../../_images/outer_demo_1.gv.svg" /><p>Another case is the <code class="docutils literal notranslate"><span class="pre">missing_demo_1</span></code> which is based on left mode. In this case, <code class="docutils literal notranslate"><span class="pre">t2.a</span></code> is ignore due to the property of left mode, <code class="docutils literal notranslate"><span class="pre">t2.x.f</span></code> is missing but <code class="docutils literal notranslate"><span class="pre">t1.x.f</span></code> can be found, so <code class="docutils literal notranslate"><span class="pre">t2.x.f</span></code> will use the missing value <code class="docutils literal notranslate"><span class="pre">0</span></code>. Finally, <code class="docutils literal notranslate"><span class="pre">t3</span></code> will be the result of left addition of <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code>, with missing value of <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<img alt="../../_images/missing_demo_1.gv.svg" class="align-center" src="../../_images/missing_demo_1.gv.svg" /><p>Considering another complex case, when the values of tree are primitive lists, like the <code class="docutils literal notranslate"><span class="pre">missing_demo_2</span></code> which is based on outer mode. At this time, if we need to do addition with missing value supported, we can set the missing value to an empty list. The result is like below.</p>
<img alt="../../_images/missing_demo_2.gv.svg" class="align-center" src="../../_images/missing_demo_2.gv.svg" /><div class="admonition note">
<p class="admonition-title">Note</p>
<p>In <code class="docutils literal notranslate"><span class="pre">missing_demo_2</span></code>, <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">:[]</span></code> will be the value of <code class="docutils literal notranslate"><span class="pre">missing</span></code> argument in actual code.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">missing</span></code> argument, its value will be automatically executed when it is callable, and its execution’s return value will be the actual missing value.</p>
<p>By passing a lambda expression in, you can construct a new object everytime missing value is required, and the duplication of the missing value’s object will be avoided. So it is not recommended to use <code class="docutils literal notranslate"><span class="pre">missing</span></code> argument like <code class="docutils literal notranslate"><span class="pre">[]</span></code>, <code class="docutils literal notranslate"><span class="pre">{}</span></code> or <code class="docutils literal notranslate"><span class="pre">myobject()</span></code> in python code, but <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">:[]</span></code>, <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">:{}</span></code> and <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">:myobject()</span></code> are better practices.</p>
</div>
<p>Here is a real code example of missing_value.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">func_treelize</span><span class="p">,</span> <span class="n">FastTreeValue</span>


<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[])</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span>
            <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
            <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">23</span><span class="p">],</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">37</span><span class="p">],</span>
            <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The stdout (no error occurred) should be like below, the calculation of <code class="docutils literal notranslate"><span class="pre">plus</span></code> function  will be processed properly, like the result in <code class="docutils literal notranslate"><span class="pre">missing_demo_2</span></code>.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>plus(t1, t2):
&lt;TreeValue 0x7f1cb6d94810 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; [23]
├── &#39;b&#39; --&gt; [2, 3, 29, 31]
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f1cb6d941d0 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; [5, 37]
    ├── &#39;d&#39; --&gt; [7, 11, 13, 41, 43]
    └── &#39;e&#39; --&gt; [17, 19]
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Missing value will be only applied in left mode and outer mode.</p>
<p>In strict mode, missing or overage of keys are absolutely not tolerated, missing value will make no sense and a <code class="docutils literal notranslate"><span class="pre">RuntimeWarning</span></code> will be logged.</p>
<p>In inner mode, missing value will never be actually in use because all the key sets of final result are intersection set of argument trees. There will never be any key missing cases at all when inner mode is used, a <code class="docutils literal notranslate"><span class="pre">RuntimeWarning</span></code> will be logged with the usage of missing value in inner mode.</p>
</div>
</div>
<div class="section" id="functional-utilities">
<h2>Functional Utilities<a class="headerlink" href="#functional-utilities" title="Permalink to this headline">¶</a></h2>
<p>In the primitive python, some convenient functional operations are supported, such as</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># map function</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result of map:&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])))</span>

    <span class="c1"># filter function</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result of filter:&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])))</span>
</pre></div>
</td></tr></table></div>
<p>The result should be</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>Result of map: [3, 4, 6, 8]
Result of filter: [3, 7]
</pre></div>
</td></tr></table></div>
<p>Actually, functional operations are supported in tree values as well, and they will be introduced in this section.</p>
<div class="section" id="mapping">
<h3>Mapping<a class="headerlink" href="#mapping" title="Permalink to this headline">¶</a></h3>
<p>Mapping function is similar to the primitive <code class="docutils literal notranslate"><span class="pre">map</span></code> function. The relation between <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> and <code class="docutils literal notranslate"><span class="pre">mapping</span></code> function is like that between <code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">map</span></code> function.</p>
<p>Here is a simple real code example</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">FastTreeValue</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mapping(t, lambda x: x ** x + 2):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mapping</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>The mapped tree result should be like below.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>mapping(t, lambda x: x ** x + 2):
&lt;FastTreeValue 0x7f5d1af91e50 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 3
├── &#39;b&#39; --&gt; 6
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f5d1afad0d0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 29
    └── &#39;d&#39; --&gt; 258
</pre></div>
</td></tr></table></div>
<p>For further definition or source code implement of function <code class="docutils literal notranslate"><span class="pre">mapping</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-mapping"><span class="std std-ref">mapping</span></a>.</p>
</div>
<div class="section" id="filter">
<h3>Filter<a class="headerlink" href="#filter" title="Permalink to this headline">¶</a></h3>
<p>Filter function is similar to the primitive <code class="docutils literal notranslate"><span class="pre">filter</span></code> function. The relation between <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> and <code class="docutils literal notranslate"><span class="pre">filter_</span></code> function is like that between <code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">filter</span></code> function .</p>
<p>Here is a simple real code example</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">filter_</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;filter_(t, lambda x: x % 2 == 1):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">filter_</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;filter_(t, lambda x: x % 2 == 1, remove_empty=False):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">filter_</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">remove_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>The filtered tree result should be like below. When <code class="docutils literal notranslate"><span class="pre">remove_empty</span></code> is disabled, the empty tree node will be kept to make sure the structure of the result tree is similar to the unfiltered tree.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>filter_(t, lambda x: x % 2 == 1):
&lt;FastTreeValue 0x7f3e16de99d0 keys: [&#39;a&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f3e16de9ed0 keys: [&#39;c&#39;]&gt;
    └── &#39;c&#39; --&gt; 3

filter_(t, lambda x: x % 2 == 1, remove_empty=False):
&lt;FastTreeValue 0x7f3e16dcda50 keys: [&#39;a&#39;, &#39;x&#39;, &#39;y&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f3e16dd3550 keys: [&#39;c&#39;]&gt;
│   └── &#39;c&#39; --&gt; 3
└── &#39;y&#39; --&gt; &lt;FastTreeValue 0x7f3e16dd3850 keys: []&gt;
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Actually, the code above is equal to the code below. The <code class="docutils literal notranslate"><span class="pre">filter_</span></code> function can be seen as a combination of <code class="docutils literal notranslate"><span class="pre">mask</span></code> function and <code class="docutils literal notranslate"><span class="pre">mapping</span></code> function.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">mask</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mask(t, mapping(t, lambda x: x % 2 == 1)):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mask</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">mapping</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mask(t, mapping(t, lambda x: x % 2 == 1), remove_empty=False):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mask</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">mapping</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span> <span class="n">remove_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>The result should be like below, exactly the same as the code above.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>mask(t, mapping(t, lambda x: x % 2 == 1)):
&lt;FastTreeValue 0x7fa1d9389ad0 keys: [&#39;a&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7fa1d9389f50 keys: [&#39;c&#39;]&gt;
    └── &#39;c&#39; --&gt; 3

mask(t, mapping(t, lambda x: x % 2 == 1), remove_empty=False):
&lt;FastTreeValue 0x7fa1d936e9d0 keys: [&#39;a&#39;, &#39;x&#39;, &#39;y&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7fa1d93734d0 keys: [&#39;c&#39;]&gt;
│   └── &#39;c&#39; --&gt; 3
└── &#39;y&#39; --&gt; &lt;FastTreeValue 0x7fa1d93737d0 keys: []&gt;
</pre></div>
</td></tr></table></div>
<p>For further information about <code class="docutils literal notranslate"><span class="pre">mask</span></code> function, take a look at <a class="reference internal" href="#tutorials-advancedusage-functional-mask"><span class="std std-ref">Mask</span></a>.</p>
</div>
<p>For further definition or source code implement of function <code class="docutils literal notranslate"><span class="pre">filter_</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-filter"><span class="std std-ref">filter_</span></a>.</p>
</div>
<div class="section" id="mask">
<span id="tutorials-advancedusage-functional-mask"></span><h3>Mask<a class="headerlink" href="#mask" title="Permalink to this headline">¶</a></h3>
<p>Mask function allow your choice in one tree, by another tree of true-or-false flags. A simple code example is</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">mask</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mask(t, m):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mask</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mask(t, m, remove_empty=False):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mask</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">remove_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>The result will be like below, values mapped with the tree <code class="docutils literal notranslate"><span class="pre">m</span></code> which mask flag is <code class="docutils literal notranslate"><span class="pre">False</span></code> are all deleted. Also, <code class="docutils literal notranslate"><span class="pre">remove_empty</span></code> argument is supported.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>mask(t, m):
&lt;FastTreeValue 0x7f59ecff4710 keys: [&#39;a&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f59ecff40d0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    └── &#39;d&#39; --&gt; 4

mask(t, m, remove_empty=False):
&lt;FastTreeValue 0x7f59ecff4710 keys: [&#39;a&#39;, &#39;x&#39;, &#39;y&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f59ecfd5750 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
│   ├── &#39;c&#39; --&gt; 3
│   └── &#39;d&#39; --&gt; 4
└── &#39;y&#39; --&gt; &lt;FastTreeValue 0x7f59ed3793d0 keys: []&gt;
</pre></div>
</td></tr></table></div>
<p>For further definition or source code implement of function <code class="docutils literal notranslate"><span class="pre">mask</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-mask"><span class="std std-ref">mask</span></a>.</p>
</div>
<div class="section" id="reduce">
<h3>Reduce<a class="headerlink" href="#reduce" title="Permalink to this headline">¶</a></h3>
<p>By using <code class="docutils literal notranslate"><span class="pre">reduce_</span></code> function, you can get some calculation result based on the tree structure. Its meaning is similar to primitive <code class="docutils literal notranslate"><span class="pre">reduce_</span></code> function, but its base structure is <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> instead of sequence or iterator. For example, we can get the sum and multiply accumulation of the values in the tree.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="fm">__mul__</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">reduce_</span><span class="p">,</span> <span class="n">FastTreeValue</span>


<span class="k">def</span> <span class="nf">multi</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="fm">__mul__</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum of t:&quot;</span><span class="p">,</span> <span class="n">reduce_</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Multiply of t:&quot;</span><span class="p">,</span> <span class="n">reduce_</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">multi</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
</pre></div>
</td></tr></table></div>
<p>The result should be like below.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>Sum of t: 24
Multiply of t: 1152
</pre></div>
</td></tr></table></div>
<p>If we use <code class="docutils literal notranslate"><span class="pre">reduce_</span></code> function with <code class="docutils literal notranslate"><span class="pre">mapping</span></code> function, huffman weight sum can also be easily calculated with the code below.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">reduce_</span><span class="p">,</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">mapping</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>

    <span class="n">weights</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="n">v</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weight tree:&quot;</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Huffman weight sum of t:&quot;</span><span class="p">,</span>
          <span class="n">reduce_</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="k">lambda</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
</pre></div>
</td></tr></table></div>
<p>The result should be like below.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>Weight tree: &lt;FastTreeValue 0x7f260f298ed0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;, &#39;y&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
├── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f260f298790 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
│   ├── &#39;c&#39; --&gt; 6
│   └── &#39;d&#39; --&gt; 8
└── &#39;y&#39; --&gt; &lt;FastTreeValue 0x7f260f298a90 keys: [&#39;e&#39;, &#39;f&#39;]&gt;
    ├── &#39;e&#39; --&gt; 12
    └── &#39;f&#39; --&gt; 16

Huffman weight sum of t: 45
</pre></div>
</td></tr></table></div>
<p>Besides, we can easily calculate sum of the <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> objects’ bytes size, like the following code.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">reduce_</span><span class="p">,</span> <span class="n">FastTreeValue</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]),</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
            <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
        <span class="p">},</span>
    <span class="p">})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Size tree:&quot;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">nbytes</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total bytes of arrays in t:&quot;</span><span class="p">,</span>
          <span class="n">reduce_</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">nbytes</span><span class="p">,</span> <span class="k">lambda</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
</pre></div>
</td></tr></table></div>
<p>The result should be like below.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>Size tree: &lt;FastTreeValue 0x7f6d77b40550 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 72
├── &#39;b&#39; --&gt; 32
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f6d77b40210 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 32
    └── &#39;d&#39; --&gt; 48

Total bytes of arrays in t: 184
</pre></div>
</td></tr></table></div>
<p>For further definition or source code implement of function <code class="docutils literal notranslate"><span class="pre">reduce_</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-reduce"><span class="std std-ref">reduce_</span></a>.</p>
</div>
</div>
<div class="section" id="structural-utilities">
<h2>Structural Utilities<a class="headerlink" href="#structural-utilities" title="Permalink to this headline">¶</a></h2>
<p>In order to process some structured data, especially when you need to process a sort of <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> objects which is in the primitive collections or mappings, the structural utilities are designed, and they will be introduced in this section with examples.</p>
<div class="section" id="union">
<h3>Union<a class="headerlink" href="#union" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">union</span></code> function is similar to the primitive <code class="docutils literal notranslate"><span class="pre">zip</span></code> function some ways, it can combine a list of <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> objects as one <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> object which leaf values are tuples, like the simple example below.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">union</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">}})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">}})</span>
    <span class="n">t4</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;union(t1, t2):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">union</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;union(t1, t2, t3):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">union</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;union(t1, t2, t3, t4):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">union</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">,</span> <span class="n">t4</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>The result should be like below, the leaf values are unionised as tuples.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>union(t1, t2):
&lt;FastTreeValue 0x7f3f71c4ba90 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; (1, 11)
├── &#39;b&#39; --&gt; (2, 22)
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f3f71c4bd90 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; (3, 30)
    ├── &#39;d&#39; --&gt; (4, 48)
    └── &#39;e&#39; --&gt; (5, 54)

union(t1, t2, t3):
&lt;FastTreeValue 0x7f3f71c68290 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; (1, 11, -13)
├── &#39;b&#39; --&gt; (2, 22, -7)
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f3f71c68750 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; (3, 30, -5)
    ├── &#39;d&#39; --&gt; (4, 48, -3)
    └── &#39;e&#39; --&gt; (5, 54, -2)

union(t1, t2, t3, t4):
&lt;FastTreeValue 0x7f3f71c4bb90 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; (1, 11, -13, -13)
├── &#39;b&#39; --&gt; (2, 22, -7, -7)
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f3f71c46fd0 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; (3, 30, -5, 8)
    ├── &#39;d&#39; --&gt; (4, 48, -3, 8)
    └── &#39;e&#39; --&gt; (5, 54, -2, 8)
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In <code class="docutils literal notranslate"><span class="pre">union</span></code> function (actually <code class="docutils literal notranslate"><span class="pre">subside</span></code> function has the same property), all the trees to be unionised need to have the same structure. You can just consider it as strict mode with inheriting is enabled.</p>
</div>
<p>For further information and arguments of function <code class="docutils literal notranslate"><span class="pre">union</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-union"><span class="std std-ref">union</span></a>.</p>
</div>
<div class="section" id="subside">
<h3>Subside<a class="headerlink" href="#subside" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">subside</span></code> function can transform the collections or mapping nested <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> objects into one <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> object which leaf values has the dispatch’s structure. The <code class="docutils literal notranslate"><span class="pre">union</span></code> function mentioned above is also based on the <code class="docutils literal notranslate"><span class="pre">subside</span></code> function. Function <code class="docutils literal notranslate"><span class="pre">subside</span></code> will greatly simplify the code when the structured data need to be calculated. Just like this following example code.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">subside</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">}})</span>
    <span class="n">t4</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}})</span>
    <span class="n">t5</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">17</span><span class="p">}})</span>

    <span class="n">st</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">),</span> <span class="s1">&#39;second&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">t3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">t4</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">t5</span><span class="p">}]}</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;subside(st):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">subside</span><span class="p">(</span><span class="n">st</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>The result should be like below, the leaf values are combined as the dispatch structure of <code class="docutils literal notranslate"><span class="pre">st</span></code>.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>subside(st):
&lt;TreeValue 0x7fb345ee4590 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; {&#39;first&#39;: (1, -14), &#39;second&#39;: [6, {&#39;x&#39;: 0, &#39;y&#39;: 3}]}
├── &#39;b&#39; --&gt; {&#39;first&#39;: (2, 9), &#39;second&#39;: [0, {&#39;x&#39;: -17, &#39;y&#39;: 9}]}
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fb345ee4950 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; {&#39;first&#39;: (3, 3), &#39;second&#39;: [-5, {&#39;x&#39;: -8, &#39;y&#39;: 11}]}
    └── &#39;d&#39; --&gt; {&#39;first&#39;: (4, 8), &#39;second&#39;: [17, {&#39;x&#39;: 15, &#39;y&#39;: -17}]}
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In function <code class="docutils literal notranslate"><span class="pre">subside</span></code>, only primitive list, tuple and dict (or subclasses) objects will be subsided to leaf values.</p>
</div>
<p>For further information and arguments of function <code class="docutils literal notranslate"><span class="pre">subside</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-subside"><span class="std std-ref">subside</span></a>.</p>
</div>
<div class="section" id="rise">
<h3>Rise<a class="headerlink" href="#rise" title="Permalink to this headline">¶</a></h3>
<p>Function <code class="docutils literal notranslate"><span class="pre">rise</span></code> can be seen as the inverse operation of function <code class="docutils literal notranslate"><span class="pre">subside</span></code>, it will try to extract the greatest common structure of the leaf values, and rise them up to the dispatch above the <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> objects. Like the following example code.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">subside</span><span class="p">,</span> <span class="n">rise</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># The same demo as the subside docs</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">}})</span>
    <span class="n">t4</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}})</span>
    <span class="n">t5</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">17</span><span class="p">}})</span>
    <span class="n">st</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">),</span> <span class="s1">&#39;second&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">t3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">t4</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">t5</span><span class="p">}]}</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">subside</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>

    <span class="c1"># Rising process</span>
    <span class="n">st2</span> <span class="o">=</span> <span class="n">rise</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">st2</span> <span class="o">==</span> <span class="n">st</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;st2:&#39;</span><span class="p">,</span> <span class="n">st2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;first&#39;][0]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;first&#39;][1]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;second&#39;][0]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;second&#39;][1][&#39;x&#39;]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;second&#39;][1][&#39;y&#39;]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<p>The result should be like below, the subsided tree <code class="docutils literal notranslate"><span class="pre">st</span></code> can be extract back to the original structure.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>st2: {&#39;first&#39;: (&lt;TreeValue 0x7fef37bac150 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;, &lt;TreeValue 0x7fef37bac350 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;), &#39;second&#39;: [&lt;TreeValue 0x7fef37bab550 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;, {&#39;x&#39;: &lt;TreeValue 0x7fef37bab910 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;, &#39;y&#39;: &lt;TreeValue 0x7fef37c23250 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;}]}
st2[&#39;first&#39;][0]:
&lt;TreeValue 0x7fef37bac150 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fef37bac1d0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    └── &#39;d&#39; --&gt; 4

st2[&#39;first&#39;][1]:
&lt;TreeValue 0x7fef37bac350 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; -14
├── &#39;b&#39; --&gt; 9
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fef37bac710 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    └── &#39;d&#39; --&gt; 8

st2[&#39;second&#39;][0]:
&lt;TreeValue 0x7fef37bab550 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 6
├── &#39;b&#39; --&gt; 0
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fef37bac550 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; -5
    └── &#39;d&#39; --&gt; 17

st2[&#39;second&#39;][1][&#39;x&#39;]:
&lt;TreeValue 0x7fef37bab910 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 0
├── &#39;b&#39; --&gt; -17
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fef37bab790 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; -8
    └── &#39;d&#39; --&gt; 15

st2[&#39;second&#39;][1][&#39;y&#39;]:
&lt;TreeValue 0x7fef37c23250 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 3
├── &#39;b&#39; --&gt; 9
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fef37bab750 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 11
    └── &#39;d&#39; --&gt; -17
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In function <code class="docutils literal notranslate"><span class="pre">rise</span></code>, only primitive list, tuple and dict (or subclasses) objects will join the rising operation.</p>
<p>Actually, when <code class="docutils literal notranslate"><span class="pre">template</span></code> argument is not assigned, the <code class="docutils literal notranslate"><span class="pre">rise</span></code> function will try to find the greatest common structure and rise them to the dispatch. The following rules will be strictly followed when doing this:</p>
<ul class="simple">
<li><p>If the values in current level have the same type ( must all be list, all be tuple or all be dict), the rising function will carry on the find sub structure, otherwise values in current level will be treated as atomic values.</p></li>
<li><p>If all of them are dicts, and they have exactly the same key sets with each other, the finding of sub structures will be carried on, otherwise these dicts will be treated as atomic values.</p></li>
<li><p>If all of them are lists, and they have the same length with each other, the finding of sub structures will be carried on, otherwise these dicts will be treated as atomic values.</p></li>
<li><p>If all of them are tuples, and they have the same length with each other, the finding of sub structures will be carried on, otherwise these dicts will be treated as atomic values. (Actually, this rule is the same as the last one which is about lists.)</p></li>
</ul>
<p>Considering this automatic structure finding process, if you only want to extract some of the structure (make sure the extraction will not be too deep or too shallow, and make sure the result will have the same structure as your expectation), you can assign value in <code class="docutils literal notranslate"><span class="pre">template</span></code> arguments. Like the example code below.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">subside</span><span class="p">,</span> <span class="n">rise</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># The same demo as the subside docs</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">}})</span>
    <span class="n">t4</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}})</span>
    <span class="n">t5</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">17</span><span class="p">}})</span>
    <span class="n">st</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">),</span> <span class="s1">&#39;second&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">t3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">t4</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">t5</span><span class="p">}]}</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">subside</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>

    <span class="c1"># Rising process, with template</span>
    <span class="c1"># only the top-leveled dict will be extracted,</span>
    <span class="c1"># neither tuple, list nor low-leveled dict will not be extracted</span>
    <span class="c1"># because they are not defined in `template` argument</span>
    <span class="n">st2</span> <span class="o">=</span> <span class="n">rise</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]})</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;st2:&#39;</span><span class="p">,</span> <span class="n">st2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;first&#39;]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;second&#39;][0]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;second&#39;][1]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<p>The result should be like below, the subsided tree <code class="docutils literal notranslate"><span class="pre">st</span></code> can be extract back to the structure of dict with only <code class="docutils literal notranslate"><span class="pre">first</span></code> and <code class="docutils literal notranslate"><span class="pre">second</span></code> keys.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>st2: {&#39;first&#39;: &lt;TreeValue 0x7f46a24f22d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;, &#39;second&#39;: [&lt;TreeValue 0x7f46a24f2450 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;, &lt;TreeValue 0x7f46a24f0610 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;]}
st2[&#39;first&#39;]:
&lt;TreeValue 0x7f46a24f22d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; (1, -14)
├── &#39;b&#39; --&gt; (2, 9)
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f46a24f2850 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; (3, 3)
    └── &#39;d&#39; --&gt; (4, 8)

st2[&#39;second&#39;][0]:
&lt;TreeValue 0x7f46a24f2450 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 6
├── &#39;b&#39; --&gt; 0
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f46a24f2650 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; -5
    └── &#39;d&#39; --&gt; 17

st2[&#39;second&#39;][1]:
&lt;TreeValue 0x7f46a24f0610 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; {&#39;x&#39;: 0, &#39;y&#39;: 3}
├── &#39;b&#39; --&gt; {&#39;x&#39;: -17, &#39;y&#39;: 9}
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f46a24f0a90 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; {&#39;x&#39;: -8, &#39;y&#39;: 11}
    └── &#39;d&#39; --&gt; {&#39;x&#39;: 15, &#39;y&#39;: -17}
</pre></div>
</td></tr></table></div>
</div>
<p>For further information and arguments of function <code class="docutils literal notranslate"><span class="pre">rise</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-rise"><span class="std std-ref">rise</span></a>.</p>
</div>
</div>
<div class="section" id="tree-utilities">
<h2>Tree Utilities<a class="headerlink" href="#tree-utilities" title="Permalink to this headline">¶</a></h2>
<p>In this section, utilities with <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> class and its objects themselves will be introduced with examples.</p>
<div class="section" id="jsonify">
<h3>Jsonify<a class="headerlink" href="#jsonify" title="Permalink to this headline">¶</a></h3>
<p>With the usage of <code class="docutils literal notranslate"><span class="pre">jsonify</span></code> function, you can transform a <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> object to json-formatted data.</p>
<p>For example, the following real code</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">raw</span><span class="p">,</span> <span class="n">jsonify</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">raw</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}),</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="s2">&quot;this is a string&quot;</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tree t:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Json data of t:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">jsonify</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>The result should be</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>Tree t:
&lt;TreeValue 0x7f50af958450 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; [2, 3]
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f50af9cdad0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; {&#39;x&#39;: 1, &#39;y&#39;: 2}
    └── &#39;d&#39; --&gt; &#39;this is a string&#39;

Json data of t:
{
    &quot;a&quot;: 1,
    &quot;b&quot;: [
        2,
        3
    ],
    &quot;x&quot;: {
        &quot;c&quot;: {
            &quot;x&quot;: 1,
            &quot;y&quot;: 2
        },
        &quot;d&quot;: &quot;this is a string&quot;
    }
}
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">raw</span></code> in the example code above is a wrapper for dictionary object. It can be used to pass <code class="docutils literal notranslate"><span class="pre">dict</span></code> object as simple value in <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> instead of being treated as sub tree.</p>
<p>For further information of function <code class="docutils literal notranslate"><span class="pre">raw</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/common.html#apidoc-tree-common-raw"><span class="std std-ref">raw</span></a>.</p>
</div>
<p>For further informaon of function <code class="docutils literal notranslate"><span class="pre">jsonify</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-jsonify"><span class="std std-ref">jsonify</span></a>.</p>
</div>
<div class="section" id="view">
<h3>View<a class="headerlink" href="#view" title="Permalink to this headline">¶</a></h3>
<p>Another magic function named <code class="docutils literal notranslate"><span class="pre">view</span></code> is also provided, to process logic viewing cases.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">view</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tree t:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="n">t_x_y</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">y</span>
    <span class="n">vt_x_y</span> <span class="o">=</span> <span class="n">view</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;t.x.y:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t_x_y</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;View of t, [&#39;x&#39;, &#39;y&#39;]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">vt_x_y</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;cc&#39;</span><span class="p">:</span> <span class="mi">33</span><span class="p">,</span> <span class="s1">&#39;dd&#39;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ee&#39;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span> <span class="s1">&#39;ff&#39;</span><span class="p">:</span> <span class="mi">66</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;t_x_y after replacement:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t_x_y</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;View of t, [&#39;x&#39;, &#39;y&#39;] after replacement:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">vt_x_y</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The result will be like below, <code class="docutils literal notranslate"><span class="pre">t_x_y</span></code> and <code class="docutils literal notranslate"><span class="pre">vt_x_y</span></code>’s value is different after the replacement of the sub tree named <code class="docutils literal notranslate"><span class="pre">t.x</span></code>, for <code class="docutils literal notranslate"><span class="pre">vt_x_y</span></code>’s value’s equality to the current <code class="docutils literal notranslate"><span class="pre">t.x.y</span></code>.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>Tree t:
&lt;TreeValue 0x7f325ca11610 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f325ca11810 keys: [&#39;c&#39;, &#39;d&#39;, &#39;y&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    ├── &#39;d&#39; --&gt; 4
    └── &#39;y&#39; --&gt; &lt;TreeValue 0x7f325ca11310 keys: [&#39;e&#39;, &#39;f&#39;]&gt;
        ├── &#39;e&#39; --&gt; 5
        └── &#39;f&#39; --&gt; 6

t.x.y:
&lt;TreeValue 0x7f325ca11310 keys: [&#39;e&#39;, &#39;f&#39;]&gt;
├── &#39;e&#39; --&gt; 5
└── &#39;f&#39; --&gt; 6

View of t, [&#39;x&#39;, &#39;y&#39;]:
&lt;TreeValue 0x7f325ca11310 keys: [&#39;e&#39;, &#39;f&#39;]&gt;
├── &#39;e&#39; --&gt; 5
└── &#39;f&#39; --&gt; 6

t_x_y after replacement:
&lt;TreeValue 0x7f325ca11310 keys: [&#39;e&#39;, &#39;f&#39;]&gt;
├── &#39;e&#39; --&gt; 5
└── &#39;f&#39; --&gt; 6

View of t, [&#39;x&#39;, &#39;y&#39;] after replacement:
&lt;TreeValue 0x7f325c672190 keys: [&#39;ee&#39;, &#39;ff&#39;]&gt;
├── &#39;ee&#39; --&gt; 55
└── &#39;ff&#39; --&gt; 66
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Attention that the <code class="docutils literal notranslate"><span class="pre">view</span></code> operation is different from sub node getting operation. In viewed tree, it is based on a logic link based on the tree be viewed, and the actual operations are performed in the actual tree node. The main difference between <code class="docutils literal notranslate"><span class="pre">view</span></code> and getting sub node is that the view tree will be affected by the replacement of sub nodes in viewed tree.</p>
<p>Like the code example above, in the view tree <code class="docutils literal notranslate"><span class="pre">vt_x_y</span></code>, before do tree operations, the viewed tree will be approached from root tree <code class="docutils literal notranslate"><span class="pre">t</span></code> by keys of <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>, so after the replacement of the whole subtree <code class="docutils literal notranslate"><span class="pre">t.x</span></code>, <code class="docutils literal notranslate"><span class="pre">vt_x_y</span></code> is still the latest value of <code class="docutils literal notranslate"><span class="pre">t.x.y</span></code>, while <code class="docutils literal notranslate"><span class="pre">t_x_y</span></code> is still the old sub tree of tree <code class="docutils literal notranslate"><span class="pre">t</span></code>, before replacement.</p>
</div>
<p>For further informaon of function <code class="docutils literal notranslate"><span class="pre">view</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-view"><span class="std std-ref">view</span></a>.</p>
</div>
<div class="section" id="clone">
<h3>Clone<a class="headerlink" href="#clone" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> objects can be cloned deeply by <code class="docutils literal notranslate"><span class="pre">clone</span></code> function.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">clone</span><span class="p">,</span> <span class="n">raw</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">raw</span><span class="p">({</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">})}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tree t:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Id of t.x.y: </span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;clone(t):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">clone</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Id of clone(t).x.y: </span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">id</span><span class="p">(</span><span class="n">clone</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;clone(t, copy_value=True):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">clone</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">copy_value</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Id of clone(t, copy_value=True).x.y: </span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">id</span><span class="p">(</span><span class="n">clone</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">copy_value</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>The result will be like below, all the memory address of the tree nodes in cloned tree are different from those in the original tree <code class="docutils literal notranslate"><span class="pre">t</span></code> when <code class="docutils literal notranslate"><span class="pre">copy_value</span></code> argument is not set. But when <code class="docutils literal notranslate"><span class="pre">copy_value</span></code> is assigned as <code class="docutils literal notranslate"><span class="pre">True</span></code>, the address of values will be changed because of the deep copy of value.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>Tree t:
&lt;TreeValue 0x7fe718339410 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fe718339390 keys: [&#39;c&#39;, &#39;d&#39;, &#39;y&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    ├── &#39;d&#39; --&gt; 4
    └── &#39;y&#39; --&gt; {&#39;e&#39;: 5, &#39;f&#39;: 6}

Id of t.x.y: 7fe7183ee050


clone(t):
&lt;TreeValue 0x7fe717f9a350 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fe717f9a550 keys: [&#39;c&#39;, &#39;d&#39;, &#39;y&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    ├── &#39;d&#39; --&gt; 4
    └── &#39;y&#39; --&gt; {&#39;e&#39;: 5, &#39;f&#39;: 6}

Id of clone(t).x.y: 7fe7183ee050


clone(t, copy_value=True):
&lt;TreeValue 0x7fe717f98cd0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fe717f9d050 keys: [&#39;c&#39;, &#39;d&#39;, &#39;y&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    ├── &#39;d&#39; --&gt; 4
    └── &#39;y&#39; --&gt; {&#39;e&#39;: 5, &#39;f&#39;: 6}

Id of clone(t, copy_value=True).x.y: 7fe717f9d910
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Attention that in function <code class="docutils literal notranslate"><span class="pre">clone</span></code>, the values will not be deeply copied together with the tree nodes by default. <strong>The newly cloned tree’s values have the same memory address with those in original tree</strong>.</p>
<p>If deep copy of values is required when using <code class="docutils literal notranslate"><span class="pre">clone</span></code>, <code class="docutils literal notranslate"><span class="pre">copy_value</span></code> argument need to be assigned as <code class="docutils literal notranslate"><span class="pre">True</span></code>. And then a <code class="docutils literal notranslate"><span class="pre">copy.deepcopy</span></code> will be performed in <code class="docutils literal notranslate"><span class="pre">clone</span></code> function in order to do the deep copy. Also, you can define your own copy function in <code class="docutils literal notranslate"><span class="pre">copy_value</span></code> argument by just assign it as a lambda expression like <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">pickle.loads(pickle.dumps(x))</span></code>.</p>
</div>
<p>For further informaon of function <code class="docutils literal notranslate"><span class="pre">clone</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-clone"><span class="std std-ref">clone</span></a>.</p>
</div>
<div class="section" id="typetrans">
<h3>Typetrans<a class="headerlink" href="#typetrans" title="Permalink to this headline">¶</a></h3>
<p>You can use function <code class="docutils literal notranslate"><span class="pre">typetrans</span></code> to change the type of tree value object, just like the example below.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">method_treelize</span><span class="p">,</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">typetrans</span>


<span class="k">class</span> <span class="nc">MyTreeValue</span><span class="p">(</span><span class="n">TreeValue</span><span class="p">):</span>
    <span class="nd">@method_treelize</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">pw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1 ** 2:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t1</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># Transform t1 to MyTreeValue,</span>
    <span class="c1"># __pow__ operator will be disabled and pw method will be enabled.</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">typetrans</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">MyTreeValue</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t2:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t2.pw():&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">pw</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>The result will be like below. After the type transformation, <code class="docutils literal notranslate"><span class="pre">**</span></code> operator can not be used in <code class="docutils literal notranslate"><span class="pre">t2</span></code> but method <code class="docutils literal notranslate"><span class="pre">pw</span></code> which is implemented in <code class="docutils literal notranslate"><span class="pre">MyTreeValue</span></code> will be enabled.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>t1:
&lt;FastTreeValue 0x7fed95160cd0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7fed953afd90 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    └── &#39;d&#39; --&gt; 4

t1 ** 2:
&lt;FastTreeValue 0x7fed9500d790 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 4
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7fed9500d4d0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 9
    └── &#39;d&#39; --&gt; 16


t2:
&lt;MyTreeValue 0x7fed95160cd0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7fed953afd90 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    └── &#39;d&#39; --&gt; 4

t2.pw():
&lt;MyTreeValue 0x7fed9500ddd0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 6
├── &#39;b&#39; --&gt; 12
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7fed9500dc90 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 20
    └── &#39;d&#39; --&gt; 30
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In treevalue library, there can be more classes based on <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> class by your definition.</p>
<p>Different tree value class will have the different operators, methods and class methods for service, and the <code class="docutils literal notranslate"><span class="pre">__eq__</span></code> operator’s result between different type of tree values will always be <code class="docutils literal notranslate"><span class="pre">False</span></code> because of the difference of their types.</p>
<p>For further information of <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> class and user’s definition practice, just take a look at:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-treevalue"><span class="std std-ref">API documentation of TreeValue</span></a>.</p></li>
<li><p><a class="reference internal" href="../../api_doc/tree/general.html#apidoc-tree-general-fasttreevalue"><span class="std std-ref">API documentation of FastTreeValue</span></a>.</p></li>
<li><p><a class="reference internal" href="#tutorials-advancedusage-diy"><span class="std std-ref">DIY TreeValue Class</span></a>.</p></li>
</ul>
</div>
<p>For further informaon of function <code class="docutils literal notranslate"><span class="pre">typetrans</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-typetrans"><span class="std std-ref">typetrans</span></a>.</p>
</div>
</div>
<div class="section" id="object-oriented-usage">
<h2>Object Oriented Usage<a class="headerlink" href="#object-oriented-usage" title="Permalink to this headline">¶</a></h2>
<p>In <code class="docutils literal notranslate"><span class="pre">FastTreeValue</span></code> class, plenty of object-oriented operators, methods and classmethods are supported in order to simplify the actual usage. Here is a simple code example.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>

    <span class="c1"># operator support</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1 + t2:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t1</span> <span class="o">+</span> <span class="n">t2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t2 ** t1:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t2</span> <span class="o">**</span> <span class="n">t1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># utilities support</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1.map(lambda x: (x + 1) * (x + 2)):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1.reduce(lambda **kwargs: sum(kwargs.values())):&#39;</span><span class="p">,</span>
          <span class="n">t1</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># linking usage</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1.map(lambda x: (x + 1) * (x + 2)).filter(lambda x: x % 4 == 0):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># structural support</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Union result:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">FastTreeValue</span><span class="o">.</span><span class="n">union</span><span class="p">(</span>
        <span class="n">t1</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)),</span>
        <span class="n">t2</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)),</span>
    <span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;first: </span><span class="si">%d</span><span class="s1">, second: </span><span class="si">%d</span><span class="s1">, which sum is </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">))))</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>The result should be like below.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>t1 + t2:
&lt;FastTreeValue 0x7f75d37d4590 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 6
├── &#39;b&#39; --&gt; 8
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f75d37d4850 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 10
    └── &#39;d&#39; --&gt; 12

t2 ** t1:
&lt;FastTreeValue 0x7f75d37d4b50 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 5
├── &#39;b&#39; --&gt; 36
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f75d37d4f90 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 343
    └── &#39;d&#39; --&gt; 4096


t1.map(lambda x: (x + 1) * (x + 2)):
&lt;FastTreeValue 0x7f75d37d4b50 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 6
├── &#39;b&#39; --&gt; 12
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f75d37d4790 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 20
    └── &#39;d&#39; --&gt; 30

t1.reduce(lambda **kwargs: sum(kwargs.values())): 10


t1.map(lambda x: (x + 1) * (x + 2)).filter(lambda x: x % 4 == 0):
&lt;FastTreeValue 0x7f75d37c41d0 keys: [&#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;b&#39; --&gt; 12
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f75d37bdf10 keys: [&#39;c&#39;]&gt;
    └── &#39;c&#39; --&gt; 20


Union result:
&lt;FastTreeValue 0x7f75d37c4b50 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; &#39;first: 6, second: 81, which sum is 87&#39;
├── &#39;b&#39; --&gt; &#39;first: 12, second: 1024, which sum is 1036&#39;
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f75d37bd250 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; &#39;first: 20, second: 15625, which sum is 15645&#39;
    └── &#39;d&#39; --&gt; &#39;first: 30, second: 279936, which sum is 279966&#39;
</pre></div>
</td></tr></table></div>
<p>For further information of <code class="docutils literal notranslate"><span class="pre">FastTreeValue</span></code> class, take a look at <a class="reference internal" href="../../api_doc/tree/general.html#apidoc-tree-general-fasttreevalue"><span class="std std-ref">FastTreeValue</span></a>, all the supported methods and operators are listed here.</p>
</div>
<div class="section" id="diy-treevalue-class">
<span id="tutorials-advancedusage-diy"></span><h2>DIY TreeValue Class<a class="headerlink" href="#diy-treevalue-class" title="Permalink to this headline">¶</a></h2>
<p>You can define your own <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> class with your own method and class methods. Like the example code below.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">classmethod_treelize</span><span class="p">,</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">method_treelize</span>


<span class="k">class</span> <span class="nc">MyTreeValue</span><span class="p">(</span><span class="n">TreeValue</span><span class="p">):</span>
    <span class="c1"># return type will be automatically detected as `MyTreeValue`</span>
    <span class="nd">@method_treelize</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Append arguments:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">b</span>

    <span class="c1"># return type will be automatically detected as `MyTreeValue`</span>
    <span class="nd">@classmethod</span>
    <span class="nd">@classmethod_treelize</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum arguments:&quot;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">MyTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1.append(t2).append(t3):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t3</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MyTreeValue.sum(t1, t2, t3):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">MyTreeValue</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>The result should be like below.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>t1.append(t2).append(t3):
Append arguments: 1 -14
Append arguments: 2 9
Append arguments: 3 3
Append arguments: 4 8
Append arguments: -13 6
Append arguments: 11 0
Append arguments: 6 -5
Append arguments: 12 17
&lt;MyTreeValue 0x7f70773b3110 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; -7
├── &#39;b&#39; --&gt; 11
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7f70773b3550 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 1
    └── &#39;d&#39; --&gt; 29

MyTreeValue.sum(t1, t2, t3):
Sum arguments: &lt;class &#39;__main__.MyTreeValue&#39;&gt; 1 -14 6
Sum arguments: &lt;class &#39;__main__.MyTreeValue&#39;&gt; 2 9 0
Sum arguments: &lt;class &#39;__main__.MyTreeValue&#39;&gt; 3 3 -5
Sum arguments: &lt;class &#39;__main__.MyTreeValue&#39;&gt; 4 8 17
&lt;MyTreeValue 0x7f70773b3ed0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; -7
├── &#39;b&#39; --&gt; 11
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7f70773cf450 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 1
    └── &#39;d&#39; --&gt; 29
</pre></div>
</td></tr></table></div>
<p>For further information of function <code class="docutils literal notranslate"><span class="pre">method_treelize</span></code> and <code class="docutils literal notranslate"><span class="pre">classmethod_treelize</span></code>, just take a look at:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../api_doc/tree/func.html#apidoc-tree-func-methodtreelize"><span class="std std-ref">method_treelize</span></a></p></li>
<li><p><a class="reference internal" href="../../api_doc/tree/func.html#apidoc-tree-func-classmethodtreelize"><span class="std std-ref">classmethod_treelize</span></a></p></li>
</ul>
</div>
<div class="section" id="diy-treevalue-utility-class">
<h2>DIY TreeValue Utility Class<a class="headerlink" href="#diy-treevalue-utility-class" title="Permalink to this headline">¶</a></h2>
<p>You can define a pure utility class in with function <code class="docutils literal notranslate"><span class="pre">utils_class</span></code> and <code class="docutils literal notranslate"><span class="pre">classmethod_treelize</span></code>. Like the following example code.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABCMeta</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="fm">__mul__</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">utils_class</span><span class="p">,</span> <span class="n">classmethod_treelize</span><span class="p">,</span> <span class="n">TreeValue</span>


<span class="k">class</span> <span class="nc">MyTreeValue</span><span class="p">(</span><span class="n">TreeValue</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="c1"># this is the utils class</span>
<span class="nd">@utils_class</span><span class="p">(</span><span class="n">return_type</span><span class="o">=</span><span class="n">MyTreeValue</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">CalcUtils</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
    <span class="c1"># return type will be detected as `MyTreeValue` as for the utils_class</span>
    <span class="nd">@classmethod</span>
    <span class="nd">@classmethod_treelize</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum arguments:&quot;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="c1"># return type will be detected as `MyTreeValue` as for the utils_class</span>
    <span class="nd">@classmethod</span>
    <span class="nd">@classmethod_treelize</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">mul</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mul arguments:&quot;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="fm">__mul__</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CalcUtils.sum(t1, t2, t3):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">CalcUtils</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CalcUtils.mul(t1, t2, t3):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">CalcUtils</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>The result should be like below.</p>
<div class="highlight-text notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span>CalcUtils.sum(t1, t2, t3):
Sum arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 1 -14 6
Sum arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 2 9 0
Sum arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 3 3 -5
Sum arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 4 8 17
&lt;MyTreeValue 0x7f321f188cd0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; -7
├── &#39;b&#39; --&gt; 11
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7f321f188c90 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 1
    └── &#39;d&#39; --&gt; 29

CalcUtils.mul(t1, t2, t3):
Mul arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 1 -14 6
Mul arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 2 9 0
Mul arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 3 3 -5
Mul arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 4 8 17
&lt;MyTreeValue 0x7f321f189350 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; -84
├── &#39;b&#39; --&gt; 0
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7f321f1899d0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; -45
    └── &#39;d&#39; --&gt; 544
</pre></div>
</td></tr></table></div>
<p>For further information of function <code class="docutils literal notranslate"><span class="pre">utils_class</span></code> and <code class="docutils literal notranslate"><span class="pre">classmethod_treelize</span></code>, just take a look at:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../api_doc/tree/func.html#apidoc-tree-func-utilsclass"><span class="std std-ref">utils_class</span></a></p></li>
<li><p><a class="reference internal" href="../../api_doc/tree/func.html#apidoc-tree-func-classmethodtreelize"><span class="std std-ref">classmethod_treelize</span></a></p></li>
</ul>
</div>
</div>



           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../best_practice/numpy/index.html" class="btn btn-neutral float-right" title="Apply into Numpy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../basic_usage/index.html" class="btn btn-neutral float-left" title="Basic Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, HansBug, DI-engine&#39;s Contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: v0.0.1
    <span class="fa fa-caret-down"></span>
  </span>
        <div class="rst-other-versions">
                <dl>
                    <dt>Tags</dt>
                        <dd><a href="index.html">v0.0.1</a></dd>
                        <dd><a href="../../../v0.1.0/tutorials/advanced_usage/index.html">v0.1.0</a></dd>
                        <dd><a href="../../../v1.0.0/tutorials/advanced_usage/index.html">v1.0.0</a></dd>
                        <dd><a href="../../../v1.1.0/tutorials/advanced_usage/index.html">v1.1.0</a></dd>
                </dl>
                <dl>
                    <dt>Branches</dt>
                        <dd><a href="../../../doc/practice/tutorials/advanced_usage/index.html">doc/practice</a></dd>
                        <dd><a href="../../../dev/delay/tutorials/advanced_usage/index.html">dev/delay</a></dd>
                        <dd><a href="../../../main/tutorials/advanced_usage/index.html">main</a></dd>
                        <dd><a href="../../../refactor/color/tutorials/advanced_usage/index.html">refactor/color</a></dd>
                </dl>
        </div>
    </div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>