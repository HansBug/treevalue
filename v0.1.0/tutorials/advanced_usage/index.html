

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Advanced Usage &mdash; treevalue 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="CLI Usage" href="../cli_usage/index.html" />
    <link rel="prev" title="Basic Usage" href="../basic_usage/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> treevalue
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main_idea/index.html">Main Idea</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic_usage/index.html">Basic Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#function-modes">Function Modes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#strict-mode">Strict Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#left-mode">Left Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inner-mode">Inner Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outer-mode">Outer Mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#inheriting-on-trees">Inheriting on Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="#process-missing-values">Process Missing Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functional-utilities">Functional Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mapping">Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#filter">Filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mask">Mask</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reduce">Reduce</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#structural-utilities">Structural Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#union">Union</a></li>
<li class="toctree-l3"><a class="reference internal" href="#subside">Subside</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rise">Rise</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tree-utilities">Tree Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jsonify">Jsonify</a></li>
<li class="toctree-l3"><a class="reference internal" href="#view">View</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clone">Clone</a></li>
<li class="toctree-l3"><a class="reference internal" href="#typetrans">Typetrans</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#io-utilities">IO Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simple-serialize-and-deserialize">Simple Serialize and Deserialize</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-dump-and-load">Advanced Dump and Load</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#object-oriented-usage">Object Oriented Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#diy-treevalue-class">DIY TreeValue Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#more-flexible-ways-to-diy-class">More Flexible Ways to DIY Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#diy-treevalue-utility-class">DIY TreeValue Utility Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#draw-graph-for-treevalue">Draw Graph For TreeValue</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cli_usage/index.html">CLI Usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Best Practice</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../best_practice/numpy/index.html">Apply into Numpy</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/config/index.html">treevalue.config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/tree/index.html">treevalue.tree</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_doc/utils/index.html">treevalue.utils</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributor Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/architecture/index.html">Architecture</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">treevalue</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Advanced Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/advanced_usage/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
    
    
  <div class="section" id="advanced-usage">
<h1>Advanced Usage<a class="headerlink" href="#advanced-usage" title="Permalink to this headline">¶</a></h1>
<p>In this part, Some of the advanced usages of <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> will be introduced one by one with sample code and graph to explain them.</p>
<p>For further information or usage of <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> and <code class="docutils literal notranslate"><span class="pre">FastTreeValue</span></code>, you may take a look at the following pages:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> and its utilities: <a class="reference internal" href="../../api_doc/tree/tree.html"><span class="doc">treevalue.tree.tree</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">func_treelize</span></code> and other wrappers: <a class="reference internal" href="../../api_doc/tree/func.html"><span class="doc">treevalue.tree.func</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FastTreeValue</span></code> and its operators, methods: <a class="reference internal" href="../../api_doc/tree/general.html"><span class="doc">treevalue.tree.general</span></a>.</p></li>
</ul>
<div class="section" id="function-modes">
<span id="tutorials-advancedusage-modes"></span><h2>Function Modes<a class="headerlink" href="#function-modes" title="Permalink to this headline">¶</a></h2>
<p>In the basic usage description in <a class="reference internal" href="../basic_usage/index.html#tutorials-basicusage-func"><span class="std std-ref">Make function tree supported</span></a>, we can see that a common function which only support the calculation of the common values can be wrapped to support the tree-based calculation painlessly.</p>
<p>Here is the documentation of function <cite>treevalue.tree.func.func_treelize</cite>.</p>
<dl class="py function">
<dt>
<code class="sig-prename descclassname">treevalue.tree.func.</code><code class="sig-name descname">func_treelize</code><span class="sig-paren">(</span><em class="sig-param">mode: Union[str</em>, <em class="sig-param">treevalue.tree.func.func.TreeMode] = 'strict'</em>, <em class="sig-param">return_type: Optional[Type[TreeClassType_]] = &lt;class 'treevalue.tree.tree.tree.TreeValue'&gt;</em>, <em class="sig-param">inherit: bool = True</em>, <em class="sig-param">missing: Union[Any</em>, <em class="sig-param">Callable] = &lt;SingletonMark 'missing_not_allow'&gt;</em>, <em class="sig-param">subside: Optional[Union[Mapping</em>, <em class="sig-param">bool]] = None</em>, <em class="sig-param">rise: Optional[Union[Mapping</em>, <em class="sig-param">bool]] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/treevalue/tree/func/func.html#func_treelize"><span class="viewcode-link">[source]</span></a></dt>
<dd><dl>
<dt>Overview:</dt><dd><p>Wrap a common function to tree-supported function.</p>
</dd>
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>mode (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[str,</span> <span class="pre">TreeMode]</span></code>): Mode of the wrapping (string or TreeMode both okay), default is <cite>strict</cite>.</p></li>
<li><p>return_type (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Optional[Type[TreeClassType_]]</span></code>): Return type of the wrapped function, default is <cite>TreeValue</cite>.</p></li>
<li><p>inherit (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>): Allow inherit in wrapped function, default is <cite>True</cite>.</p></li>
<li><p>missing (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[Any,</span> <span class="pre">Callable]</span></code>): Missing value or lambda generator of when missing,             default is <cite>MISSING_NOT_ALLOW</cite>, which means raise <cite>KeyError</cite> when missing detected.</p></li>
<li><p>subside (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[Mapping,</span> <span class="pre">bool,</span> <span class="pre">None]</span></code>): Subside enabled to function’s arguments or not,             and subside configuration, default is <cite>None</cite> which means do not use subside.             When subside is <cite>True</cite>, it will use all the default arguments in <cite>subside</cite> function.</p></li>
<li><p>rise (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Union[Mapping,</span> <span class="pre">bool,</span> <span class="pre">None]</span></code>): Rise enabled to function’s return value or not,             and rise configuration, default is <cite>None</cite> which means do not use rise.             When rise is <cite>True</cite>, it will use all the default arguments in <cite>rise</cite> function.             (Not recommend to use auto mode when your return structure is not so strict.)</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>decorator (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Callable</span></code>): Wrapper for tree-supported function.</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@func_treelize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">ssum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>  <span class="c1"># the a and b will be integers, not TreeValue</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">33</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>    <span class="c1"># 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ssum</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>  <span class="c1"># TreeValue({&#39;a&#39;: 12, &#39;b&#39;: 24, &#39;x&#39;: {&#39;c&#39;: 36, &#39;d&#39;: 9}})</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<p>In the arguments listed above, 3 of them are key arguments:</p>
<ul class="simple">
<li><p><strong>mode</strong>, Tree process mode of the calculation. Will be introduced in this section.</p></li>
<li><p><strong>inherit</strong>, Inheriting mode of the calculation on the tree. Will be introduced in <a class="reference internal" href="#tutorials-advancedusage-inherit"><span class="std std-ref">Inheriting on Trees</span></a>.</p></li>
<li><p><strong>missing</strong>, Missing processor of the calculation on the tree. Will be introduced in <a class="reference internal" href="#tutorials-advancedusage-missing"><span class="std std-ref">Process Missing Values</span></a>.</p></li>
</ul>
<p>The mode argument is the most important argument in function <code class="docutils literal notranslate"><span class="pre">func_treelize</span></code>. For it depends the basic logic of the graph calculation.</p>
<p>The type of <code class="docutils literal notranslate"><span class="pre">mode</span></code> argument is <code class="docutils literal notranslate"><span class="pre">TreeMode</span></code>, which documentation is like this.</p>
<dl class="py class enum">
<dt>
<em class="property">enum </em><code class="sig-prename descclassname">treevalue.tree.func.</code><code class="sig-name descname">TreeMode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/treevalue/tree/func/func.html#TreeMode"><span class="viewcode-link">[source]</span></a></dt>
<dd><dl class="simple">
<dt>Overview:</dt><dd><p>Four mode of the tree calculation</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Member Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
<p>Valid values are as follows:</p>
<dl class="py attribute">
<dt>
<code class="sig-name descname">STRICT</code><em class="property"> = &lt;TreeMode.STRICT: 1&gt;</em></dt>
<dd><p>Strict mode, which means the keys should be one to one in every trees.</p>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">LEFT</code><em class="property"> = &lt;TreeMode.LEFT: 2&gt;</em></dt>
<dd><p>Left mode, the keys of the result is relied on the left value.</p>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">INNER</code><em class="property"> = &lt;TreeMode.INNER: 3&gt;</em></dt>
<dd><p>Inner mode, the keys of the result is relied on the intersection of the trees’ key set.</p>
</dd></dl>

<dl class="py attribute">
<dt>
<code class="sig-name descname">OUTER</code><em class="property"> = &lt;TreeMode.OUTER: 4&gt;</em></dt>
<dd><p>Outer mode, the keys of the result is relied on the union of the trees’ key set.</p>
</dd></dl>

</dd></dl>

<p>In this part, all of the 4 modes will be introduced with details and samples one by one.</p>
<div class="section" id="strict-mode">
<h3>Strict Mode<a class="headerlink" href="#strict-mode" title="Permalink to this headline">¶</a></h3>
<p>Strict mode is the most frequently-used mode in real cases. It is also the default value of the <code class="docutils literal notranslate"><span class="pre">mode</span></code> argument in the treelize functions.</p>
<p>To be simple, strict mode need the keys of a node in the tree be strictly mapped one by one, missing or overage of the keys are both forbidden in strict mode, which means <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> will be raised.</p>
<p>For example, in the trees in <code class="docutils literal notranslate"><span class="pre">strict_demo_1</span></code>, if we need to added <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code> together, <code class="docutils literal notranslate"><span class="pre">t3</span></code> will be the result. Because all the keys (<code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">x</span></code> of the root nodes, and <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code> of the <code class="docutils literal notranslate"><span class="pre">x</span></code> node) can be mapped one by one.</p>
<img alt="../../_images/strict_demo_1.gv.svg" class="align-center" src="../../_images/strict_demo_1.gv.svg" /><p>In another situation, when the keys are not so regular like that in <code class="docutils literal notranslate"><span class="pre">strict_demo_1</span></code>, like the trees in <code class="docutils literal notranslate"><span class="pre">strict_demo_2</span></code>. If we try to add <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code> in strict mode, <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> will be raised due to the missing of key <code class="docutils literal notranslate"><span class="pre">a</span></code> in <code class="docutils literal notranslate"><span class="pre">t1</span></code> and key <code class="docutils literal notranslate"><span class="pre">f</span></code> in <cite>t2.x</cite>.</p>
<img alt="../../_images/strict_demo_2.gv.svg" class="align-center" src="../../_images/strict_demo_2.gv.svg" /><p>Here is a real code example of strict mode.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">func_treelize</span>


<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;strict&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">}})</span>
    <span class="n">t4</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t4, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t4</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
</pre></div></td></tr></table></div>
</div>
<p>The stdout and stderr should like below, a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> is raised at the second <code class="docutils literal notranslate"><span class="pre">print</span></code> statement.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span>plus(t1, t2): &lt;TreeValue 0x7f63fd234850 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 12
├── &#39;b&#39; --&gt; 24
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f63fd2a8bd0 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    ├── &#39;d&#39; --&gt; 52
    └── &#39;e&#39; --&gt; 59
</pre></div></td></tr></table></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span>Traceback (most recent call last):
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/docs/source/tutorials/advanced_usage/strict_demo.demox.py&quot;, line 15, in &lt;module&gt;
    print(&#39;plus(t4, t2):&#39;, plus(t4, t2))
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 152, in _new_func
    _result = _recursion(*args, **kwargs)
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 142, in _recursion
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/strict.py&quot;, line 15, in get_key_set
    a2=repr(index), ks2=repr(keyset),
KeyError: &quot;Argument keys not match in strict mode, key set of argument 1 is (&#39;b&#39;, &#39;x&#39;) but 2 in (&#39;a&#39;, &#39;b&#39;, &#39;x&#39;).&quot;
</pre></div></td></tr></table></div>
</div>
<div class="admonition note" id="tutorials-advancedusage-how-works">
<p class="admonition-title">Note</p>
<p>How does the treelized function work?</p>
<p>Here is another example which show the actual calculation process of the wrapped function.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">func_treelize</span>


<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;strict&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current a and b:&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">a</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]),</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">]),</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mf">4.8</span><span class="p">,</span>
            <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]),</span>
        <span class="p">}</span>
    <span class="p">})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]),</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mf">4.8</span><span class="p">,</span>
            <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]),</span>
        <span class="p">}</span>
    <span class="p">})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t3):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t3</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div></td></tr></table></div>
</div>
<p>In this code, once the original function <code class="docutils literal notranslate"><span class="pre">plus</span></code> is called, the actual value of argument <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> will be printed to stdout.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">plus(t1,</span> <span class="pre">t2)</span></code>, all the calculation can be carried on because add operator between primitive <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> is supported, so no error occurs and the result of <code class="docutils literal notranslate"><span class="pre">+</span></code> between <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> will be one of the values of the result tree.</p>
<p>But in <code class="docutils literal notranslate"><span class="pre">plus(t1,</span> <span class="pre">t3)</span></code>, when get the result of <code class="docutils literal notranslate"><span class="pre">plus(t1,</span> <span class="pre">t3).b</span></code>, it will try to add <code class="docutils literal notranslate"><span class="pre">t1.b</span></code> and <code class="docutils literal notranslate"><span class="pre">t2.b</span></code> together, but there is no implement of operator <code class="docutils literal notranslate"><span class="pre">+</span></code> between primitive <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">list</span></code> objects, so <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> will be raised when do this calculation.</p>
<p>The complete stdout and stderr should be like this.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span>Current a and b: &lt;class &#39;int&#39;&gt; 11 &lt;class &#39;numpy.ndarray&#39;&gt; [1 3 5 7]
Current a and b: &lt;class &#39;int&#39;&gt; 22 &lt;class &#39;numpy.ndarray&#39;&gt; [ 2  5  8 11]
Current a and b: &lt;class &#39;int&#39;&gt; 30 &lt;class &#39;int&#39;&gt; 3
Current a and b: &lt;class &#39;int&#39;&gt; 48 &lt;class &#39;float&#39;&gt; 4.8
Current a and b: &lt;class &#39;int&#39;&gt; 54 &lt;class &#39;numpy.ndarray&#39;&gt; [[2 3]
 [5 6]]
plus(t1, t2): &lt;TreeValue 0x7f8fc142ffd0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; array([12, 14, 16, 18])
├── &#39;b&#39; --&gt; array([24, 27, 30, 33])
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f8fc1428a90 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    ├── &#39;d&#39; --&gt; 52.8
    └── &#39;e&#39; --&gt; array([[56, 57],
       [59, 60]])


Current a and b: &lt;class &#39;int&#39;&gt; 11 &lt;class &#39;numpy.ndarray&#39;&gt; [1 3 5 7]
Current a and b: &lt;class &#39;int&#39;&gt; 22 &lt;class &#39;list&#39;&gt; [2, 5, 8, 11]
</pre></div></td></tr></table></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span>Traceback (most recent call last):
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/docs/source/tutorials/advanced_usage/strict_demo_show.demox.py&quot;, line 35, in &lt;module&gt;
    print(&#39;plus(t1, t3):&#39;, plus(t1, t3))
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 152, in _new_func
    _result = _recursion(*args, **kwargs)
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 142, in _recursion
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 142, in &lt;dictcomp&gt;
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 133, in _recursion
    return func(*args, **kwargs)
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/docs/source/tutorials/advanced_usage/strict_demo_show.demox.py&quot;, line 9, in plus
    return a + b
TypeError: unsupported operand type(s) for +: &#39;int&#39; and &#39;list&#39;
</pre></div></td></tr></table></div>
</div>
</div>
<p>In strict mode, missing or overage of keys are not tolerated at all. So in some of the cases, especially when you can not suppose that all the trees involved in calculation has exactly the same structure. Based on this demand, left mode, inner mode and outer mode is designed, and they will be introduced with details and examples in the next 3 sections.</p>
</div>
<div class="section" id="left-mode">
<h3>Left Mode<a class="headerlink" href="#left-mode" title="Permalink to this headline">¶</a></h3>
<p>In left mode, the result tree’s key set will be aligned to the first tree from the left.</p>
<p>In the trees in <code class="docutils literal notranslate"><span class="pre">left_demo_1</span></code>, <code class="docutils literal notranslate"><span class="pre">t3</span></code> is the plus result of <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code>. We can see that <cite>t2.a</cite> is ignored because of <cite>t1.a</cite> ‘s non-existence. Finally no error will be raised, the calculation will be processed properly with the tree structure of <code class="docutils literal notranslate"><span class="pre">t1</span></code>.</p>
<img alt="../../_images/left_demo_1.gv.svg" class="align-center" src="../../_images/left_demo_1.gv.svg" /><p>But in the <code class="docutils literal notranslate"><span class="pre">left_demo_2</span></code> (actually it is exactly the same as <code class="docutils literal notranslate"><span class="pre">strict_demo_2</span></code>), <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> will be raised because <cite>t2.x.f`</cite> not found in tree <code class="docutils literal notranslate"><span class="pre">t2`,</span> <span class="pre">so</span> <span class="pre">the</span> <span class="pre">result</span> <span class="pre">\</span>
<span class="pre">can</span> <span class="pre">not</span> <span class="pre">be</span> <span class="pre">aligned</span> <span class="pre">to</span> <span class="pre">tree</span> <span class="pre">``t1</span></code>, calculation failed.</p>
<img alt="../../_images/left_demo_2.gv.svg" class="align-center" src="../../_images/left_demo_2.gv.svg" /><p>When you decorate a function as left mode, the decorated function will try to find the first tree from left. If there is no less than 1 positional arguments detected, the first positional argument will be used as the left tree. Otherwise, the tree with the smallest lexicographic key will be assigned as the left tree. Obviously, As least 1 positional or key-word-based argument should be in the arguments.</p>
<p>Here is a real code example of left mode.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">func_treelize</span>


<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">}})</span>
    <span class="n">t4</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t4, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t4</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
</pre></div></td></tr></table></div>
</div>
<p>The stdout and stderr should like below, a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> is raised at the second <code class="docutils literal notranslate"><span class="pre">print</span></code> statement.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span>plus(t1, t2): &lt;TreeValue 0x7f1e34d06990 keys: [&#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;b&#39; --&gt; 24
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f1e34c5dc90 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    ├── &#39;d&#39; --&gt; 52
    └── &#39;e&#39; --&gt; 59
</pre></div></td></tr></table></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span>Traceback (most recent call last):
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/docs/source/tutorials/advanced_usage/left_demo.demox.py&quot;, line 15, in &lt;module&gt;
    print(&#39;plus(t4, t2):&#39;, plus(t4, t2))
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 152, in _new_func
    _result = _recursion(*args, **kwargs)
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 142, in _recursion
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 142, in &lt;dictcomp&gt;
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 142, in _recursion
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 142, in &lt;dictcomp&gt;
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 140, in &lt;genexpr&gt;
    *(item(key) for item in pargs),
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 118, in _get_from_key
    key=repr(key), item=repr(item),
KeyError: &quot;Missing is off, key &#39;f&#39; not found in &lt;FastTreeValue 0x7f1e34c67c90 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;.&quot;
</pre></div></td></tr></table></div>
</div>
<p>In the code example above, the result is aligned to tree <code class="docutils literal notranslate"><span class="pre">a</span></code> in wrapped function <code class="docutils literal notranslate"><span class="pre">plus</span></code>. So the first plus calculation will get the proper result, but the second one will fail.</p>
</div>
<div class="section" id="inner-mode">
<h3>Inner Mode<a class="headerlink" href="#inner-mode" title="Permalink to this headline">¶</a></h3>
<p>In inner mode, the result tree’s key set will be aligned to the intersection set of all the tree’s key set in arguments.</p>
<p>In the trees in <code class="docutils literal notranslate"><span class="pre">inner_demo_1</span></code>, <code class="docutils literal notranslate"><span class="pre">t3</span></code> is the plus result of <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code>. We can see that <code class="docutils literal notranslate"><span class="pre">t2.a</span></code> and <code class="docutils literal notranslate"><span class="pre">t1.x.f</span></code> is ignored because of <code class="docutils literal notranslate"><span class="pre">t1.a</span></code>  and <code class="docutils literal notranslate"><span class="pre">t2.x.f</span></code>’s non-existence. Finally no error will be raised, the calculation will be processed properly with the tree structure of the intersection between tree <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code>.</p>
<img alt="../../_images/inner_demo_1.gv.svg" class="align-center" src="../../_images/inner_demo_1.gv.svg" /><div class="admonition note">
<p class="admonition-title">Note</p>
<p>In most cases of inner mode, the calculation will be processed properly because of the intersection operation on the key set and key missing or overage are both avoided completely.</p>
<p>But the shortage of inner mode is the loss of some information, for keys and its value or subtrees will be directly ignored without any warning. So <strong>before using inner mode, please confirm that you know its running logic and the missing of some nodes</strong>.</p>
</div>
<p>Here is a real code example of inner mode.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">func_treelize</span>


<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">}})</span>
    <span class="n">t4</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t4, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t4</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
</pre></div></td></tr></table></div>
</div>
<p>The stdout (no stderr content in this case) should like below, no errors occurred with exit code 0.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span>plus(t1, t2): &lt;TreeValue 0x7f4f0661ba10 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 12
├── &#39;b&#39; --&gt; 24
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f4f06572d10 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    ├── &#39;d&#39; --&gt; 52
    └── &#39;e&#39; --&gt; 59

plus(t4, t2): &lt;TreeValue 0x7f4f06579650 keys: [&#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;b&#39; --&gt; 24
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f4f0656d790 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    ├── &#39;d&#39; --&gt; 52
    └── &#39;e&#39; --&gt; 59
</pre></div></td></tr></table></div>
</div>
</div>
<div class="section" id="outer-mode">
<h3>Outer Mode<a class="headerlink" href="#outer-mode" title="Permalink to this headline">¶</a></h3>
<p>In outer mode, the result tree’s key set will be aligned to the union set of the tree’s key set in arguments.</p>
<p>In the trees in <code class="docutils literal notranslate"><span class="pre">outer_demo_1</span></code>, <code class="docutils literal notranslate"><span class="pre">t3</span></code> is the plus result of <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code>, with the missing value of <code class="docutils literal notranslate"><span class="pre">0</span></code>. We can see that all the values in tree <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code> are involved in this calculation, and because of the missing of <code class="docutils literal notranslate"><span class="pre">t1.a</span></code> and <code class="docutils literal notranslate"><span class="pre">t2.x.f</span></code> they will be actually treated as <code class="docutils literal notranslate"><span class="pre">0</span></code> in calculation process. Finally no error will be raised, and sum of the tree nodes’ value will form the result tree <code class="docutils literal notranslate"><span class="pre">t3</span></code>.</p>
<img alt="../../_images/outer_demo_1.gv.svg" class="align-center" src="../../_images/outer_demo_1.gv.svg" /><div class="admonition note">
<p class="admonition-title">Note</p>
<p>In outer mode, it is strongly recommended to set the value of argument <code class="docutils literal notranslate"><span class="pre">missing</span></code>. When <code class="docutils literal notranslate"><span class="pre">missing</span></code>’s value is not set and there are key missing in some of the argument trees, <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> will be raised
due to this missing and value of <code class="docutils literal notranslate"><span class="pre">missing</span></code>.</p>
<p>For further information and examples of <code class="docutils literal notranslate"><span class="pre">missing</span></code> argument, take a look at
<a class="reference internal" href="#tutorials-advancedusage-missing"><span class="std std-ref">Process Missing Values</span></a>.</p>
</div>
<p>Here is a real code example of inner mode.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">func_treelize</span>


<span class="c1"># missing value is very important when use outer mode</span>
<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
</pre></div></td></tr></table></div>
</div>
<p>The stdout (no stderr content in this case) should like below, no errors occurred with exit code 0.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span>plus(t1, t2): &lt;TreeValue 0x7fd6067a7650 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 11
├── &#39;b&#39; --&gt; 24
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fd60681f810 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    ├── &#39;d&#39; --&gt; 52
    ├── &#39;e&#39; --&gt; 59
    └── &#39;f&#39; --&gt; 6
</pre></div></td></tr></table></div>
</div>
</div>
</div>
<div class="section" id="inheriting-on-trees">
<span id="tutorials-advancedusage-inherit"></span><h2>Inheriting on Trees<a class="headerlink" href="#inheriting-on-trees" title="Permalink to this headline">¶</a></h2>
<p>Inheriting is another important feature of treelize functions. It will be introduced in this section with necessary examples.</p>
<p>In some cases, we need to calculation between values with different dimensions, such as in <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, you can add primitive integer with a <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> object, like this</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">ar1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ar1 + 9:&#39;</span><span class="p">,</span> <span class="n">ar1</span> <span class="o">+</span> <span class="mi">9</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
</pre></div></td></tr></table></div>
</div>
<p>The result will be like below, result of <code class="docutils literal notranslate"><span class="pre">ar1</span> <span class="pre">+</span> <span class="pre">9</span></code> is actually the same as the result of expression <code class="docutils literal notranslate"><span class="pre">ar1</span> <span class="pre">+</span> <span class="pre">np.array([[9,</span> <span class="pre">9],</span> <span class="pre">[9,</span> <span class="pre">9]])</span></code>.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span>ar1 + 9:
[[10 11]
 [12 13]]
</pre></div></td></tr></table></div>
</div>
<p>In treelize functions, you can achieve this processing way by use the <code class="docutils literal notranslate"><span class="pre">inherit</span></code> argument. Considering this situation can be find almost anywhere, so the default value of <code class="docutils literal notranslate"><span class="pre">inherit</span></code> argument is <code class="docutils literal notranslate"><span class="pre">True</span></code>, which means the inheriting option is on by default.</p>
<p>We can see the example in <code class="docutils literal notranslate"><span class="pre">inherit_demo_1</span></code>, the tree <code class="docutils literal notranslate"><span class="pre">t1</span></code> and tree <code class="docutils literal notranslate"><span class="pre">t2</span></code> have different structures, and cannot be processed by any modes in <a class="reference internal" href="#tutorials-advancedusage-modes"><span class="std std-ref">Function Modes</span></a>, because <code class="docutils literal notranslate"><span class="pre">t1.x</span></code> is a primitive integer value but <code class="docutils literal notranslate"><span class="pre">t2.x</span></code> is a subtree node, their types are structurally different.</p>
<img alt="../../_images/inherit_demo_1.gv.svg" class="align-center" src="../../_images/inherit_demo_1.gv.svg" /><p>But when inheriting is enabled, this adding operation can still be carried on, for the value of <code class="docutils literal notranslate"><span class="pre">t1.x</span></code> (is <code class="docutils literal notranslate"><span class="pre">9</span></code> in <code class="docutils literal notranslate"><span class="pre">inherit_demo_1</span></code>) will be applied to the whole subtree <code class="docutils literal notranslate"><span class="pre">t2.x</span></code>, like the result tree <code class="docutils literal notranslate"><span class="pre">t3</span></code> shows. The result of tree <code class="docutils literal notranslate"><span class="pre">t3.x</span></code> can be considered as the sum of primitive integer <code class="docutils literal notranslate"><span class="pre">9</span></code> and subtree <code class="docutils literal notranslate"><span class="pre">t2.x</span></code>.</p>
<p>Based on the structural properties above, in the example of <code class="docutils literal notranslate"><span class="pre">inherit_demo_2</span></code>, a primitive value can be directly added with a complete tree, like the result tree <code class="docutils literal notranslate"><span class="pre">t2</span> <span class="pre">=</span> <span class="pre">t1</span> <span class="pre">+</span> <span class="pre">5</span></code> shows.</p>
<img alt="../../_images/inherit_demo_2.gv.svg" class="align-center" src="../../_images/inherit_demo_2.gv.svg" /><p>When inheriting is disabled, all the cases with primitive value and tree node at the same path position will cause <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>. For example, when inheriting is disabled, <code class="docutils literal notranslate"><span class="pre">inherit_demo_1</span></code> and <code class="docutils literal notranslate"><span class="pre">inherit_demo_2</span></code> will failed, but <code class="docutils literal notranslate"><span class="pre">strict_demo_1</span></code> will still success because no primitive value appears at the same path position of tree node.</p>
<img alt="../../_images/strict_demo_1.gv.svg" class="align-center" src="../../_images/strict_demo_1.gv.svg" /><p>Here is a real code example of inheriting.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">func_treelize</span>


<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;strict&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;strict&#39;</span><span class="p">,</span> <span class="n">inherit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">plusx</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t2, 5):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plusx(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plusx</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div></td></tr></table></div>
</div>
<p>The stdout and stderr should be like below, the the calculation of <code class="docutils literal notranslate"><span class="pre">plus</span></code> function and the first calculation of <code class="docutils literal notranslate"><span class="pre">plusx</span></code> function will be processed properly, but the last one will failed due to the disablement of inheriting.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span>plus(t1, t2): &lt;TreeValue 0x7fddb0148a90 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 12
├── &#39;b&#39; --&gt; 24
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fddb00a3910 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; 39
    ├── &#39;d&#39; --&gt; 57
    └── &#39;e&#39; --&gt; 63

plus(t2, 5): &lt;TreeValue 0x7fddb009f5d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 16
├── &#39;b&#39; --&gt; 27
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fddb00a6490 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; 35
    ├── &#39;d&#39; --&gt; 53
    └── &#39;e&#39; --&gt; 59
</pre></div></td></tr></table></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span>Traceback (most recent call last):
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/docs/source/tutorials/advanced_usage/inherit_demo.demox.py&quot;, line 22, in &lt;module&gt;
    print(&#39;plusx(t1, t2):&#39;, plusx(t1, t2))
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 152, in _new_func
    _result = _recursion(*args, **kwargs)
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 142, in _recursion
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 142, in &lt;dictcomp&gt;
    )) for key in sorted(_MODE_PROCESSORS[mode].get_key_set(*args, **kwargs))
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 135, in _recursion
    pargs = [_value_wrap(item, index) for index, item in enumerate(args)]
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 135, in &lt;listcomp&gt;
    pargs = [_value_wrap(item, index) for index, item in enumerate(args)]
  File &quot;/tmp/tmpn_r96apn/d08086bb624e8c20ec1bc07a22e1c784949a7006/treevalue/tree/func/func.py&quot;, line 126, in _value_wrap
    type=repr(type(item).__name__), index=repr(index),
TypeError: Inherit is off, tree value expected but &#39;int&#39; found in args 0.
</pre></div></td></tr></table></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In most cases, disablement of inheriting is not recommended because it will cause some errors. Disable inheriting can increase the structural strictness of calculation, but all the cross-dimensional tree operation will be forbidden as well.</p>
<p>So before disabling inheriting, make sure you know well about what you are going to do.</p>
</div>
</div>
<div class="section" id="process-missing-values">
<span id="tutorials-advancedusage-missing"></span><h2>Process Missing Values<a class="headerlink" href="#process-missing-values" title="Permalink to this headline">¶</a></h2>
<p>In some cases of left mode and outer mode, some of keys in result tree can not find the node nor value at the corresponding path position in some of the argument trees. In order the make these cases be processable, missing value can be used by setting value or lambda expression in <code class="docutils literal notranslate"><span class="pre">missing</span></code> argument.</p>
<p>Just like the example <code class="docutils literal notranslate"><span class="pre">outer_demo_1</span></code> mentioned forwards, when <code class="docutils literal notranslate"><span class="pre">t1.a</span></code> and <code class="docutils literal notranslate"><span class="pre">t2.x.f</span></code> not found in trees, the given missing value <code class="docutils literal notranslate"><span class="pre">0</span></code> will be used instead.</p>
<img alt="../../_images/outer_demo_1.gv.svg" class="align-center" src="../../_images/outer_demo_1.gv.svg" /><p>Another case is the <code class="docutils literal notranslate"><span class="pre">missing_demo_1</span></code> which is based on left mode. In this case, <code class="docutils literal notranslate"><span class="pre">t2.a</span></code> is ignore due to the property of left mode, <code class="docutils literal notranslate"><span class="pre">t2.x.f</span></code> is missing but <code class="docutils literal notranslate"><span class="pre">t1.x.f</span></code> can be found, so <code class="docutils literal notranslate"><span class="pre">t2.x.f</span></code> will use the missing value <code class="docutils literal notranslate"><span class="pre">0</span></code>. Finally, <code class="docutils literal notranslate"><span class="pre">t3</span></code> will be the result of left addition of <code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code>, with missing value of <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<img alt="../../_images/missing_demo_1.gv.svg" class="align-center" src="../../_images/missing_demo_1.gv.svg" /><p>Considering another complex case, when the values of tree are primitive lists, like the <code class="docutils literal notranslate"><span class="pre">missing_demo_2</span></code> which is based on outer mode. At this time, if we need to do addition with missing value supported, we can set the missing value to an empty list. The result is like below.</p>
<img alt="../../_images/missing_demo_2.gv.svg" class="align-center" src="../../_images/missing_demo_2.gv.svg" /><div class="admonition note">
<p class="admonition-title">Note</p>
<p>In <code class="docutils literal notranslate"><span class="pre">missing_demo_2</span></code>, <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">:[]</span></code> will be the value of <code class="docutils literal notranslate"><span class="pre">missing</span></code> argument in actual code.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">missing</span></code> argument, its value will be automatically executed when it is callable, and its execution’s return value will be the actual missing value.</p>
<p>By passing a lambda expression in, you can construct a new object everytime missing value is required, and the duplication of the missing value’s object will be avoided. So it is not recommended to use <code class="docutils literal notranslate"><span class="pre">missing</span></code> argument like <code class="docutils literal notranslate"><span class="pre">[]</span></code>, <code class="docutils literal notranslate"><span class="pre">{}</span></code> or <code class="docutils literal notranslate"><span class="pre">myobject()</span></code> in python code, but <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">:[]</span></code>, <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">:{}</span></code> and <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">:myobject()</span></code> are better practices.</p>
</div>
<p>Here is a real code example of missing_value.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">func_treelize</span><span class="p">,</span> <span class="n">FastTreeValue</span>


<span class="nd">@func_treelize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[])</span>
<span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span>
            <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
            <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">23</span><span class="p">],</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">37</span><span class="p">],</span>
            <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;plus(t1, t2):&#39;</span><span class="p">,</span> <span class="n">plus</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
</pre></div></td></tr></table></div>
</div>
<p>The stdout (no error occurred) should be like below, the calculation of <code class="docutils literal notranslate"><span class="pre">plus</span></code> function  will be processed properly, like the result in <code class="docutils literal notranslate"><span class="pre">missing_demo_2</span></code>.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span>plus(t1, t2):
&lt;TreeValue 0x7f87cc8f47d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; [23]
├── &#39;b&#39; --&gt; [2, 3, 29, 31]
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f87cc84ff10 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; [5, 37]
    ├── &#39;d&#39; --&gt; [7, 11, 13, 41, 43]
    └── &#39;e&#39; --&gt; [17, 19]
</pre></div></td></tr></table></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Missing value will be only applied in left mode and outer mode.</p>
<p>In strict mode, missing or overage of keys are absolutely not tolerated, missing value will make no sense and a <code class="docutils literal notranslate"><span class="pre">RuntimeWarning</span></code> will be logged.</p>
<p>In inner mode, missing value will never be actually in use because all the key sets of final result are intersection set of argument trees. There will never be any key missing cases at all when inner mode is used, a <code class="docutils literal notranslate"><span class="pre">RuntimeWarning</span></code> will be logged with the usage of missing value in inner mode.</p>
</div>
</div>
<div class="section" id="functional-utilities">
<h2>Functional Utilities<a class="headerlink" href="#functional-utilities" title="Permalink to this headline">¶</a></h2>
<p>In the primitive python, some convenient functional operations are supported, such as</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># map function</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result of map:&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])))</span>

    <span class="c1"># filter function</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Result of filter:&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])))</span>
</pre></div></td></tr></table></div>
</div>
<p>The result should be</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span>Result of map: [3, 4, 6, 8]
Result of filter: [3, 7]
</pre></div></td></tr></table></div>
</div>
<p>Actually, functional operations are supported in tree values as well, and they will be introduced in this section.</p>
<div class="section" id="mapping">
<h3>Mapping<a class="headerlink" href="#mapping" title="Permalink to this headline">¶</a></h3>
<p>Mapping function is similar to the primitive <code class="docutils literal notranslate"><span class="pre">map</span></code> function. The relation between <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> and <code class="docutils literal notranslate"><span class="pre">mapping</span></code> function is like that between <code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">map</span></code> function.</p>
<p>Here is a simple real code example</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">FastTreeValue</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mapping(t, lambda x: x ** x + 2):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mapping</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>
</pre></div></td></tr></table></div>
</div>
<p>The mapped tree result should be like below.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span>mapping(t, lambda x: x ** x + 2):
&lt;FastTreeValue 0x7f20b36e81d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 3
├── &#39;b&#39; --&gt; 6
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f20b36e2ed0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 29
    └── &#39;d&#39; --&gt; 258
</pre></div></td></tr></table></div>
</div>
<p>For further definition or source code implement of function <code class="docutils literal notranslate"><span class="pre">mapping</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-mapping"><span class="std std-ref">mapping</span></a>.</p>
</div>
<div class="section" id="filter">
<h3>Filter<a class="headerlink" href="#filter" title="Permalink to this headline">¶</a></h3>
<p>Filter function is similar to the primitive <code class="docutils literal notranslate"><span class="pre">filter</span></code> function. The relation between <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> and <code class="docutils literal notranslate"><span class="pre">filter_</span></code> function is like that between <code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">filter</span></code> function .</p>
<p>Here is a simple real code example</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">filter_</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;filter_(t, lambda x: x % 2 == 1):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">filter_</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;filter_(t, lambda x: x % 2 == 1, remove_empty=False):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">filter_</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">remove_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div></td></tr></table></div>
</div>
<p>The filtered tree result should be like below. When <code class="docutils literal notranslate"><span class="pre">remove_empty</span></code> is disabled, the empty tree node will be kept to make sure the structure of the result tree is similar to the unfiltered tree.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span>filter_(t, lambda x: x % 2 == 1):
&lt;FastTreeValue 0x7fcfc90cee90 keys: [&#39;a&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7fcfc90cead0 keys: [&#39;c&#39;]&gt;
    └── &#39;c&#39; --&gt; 3

filter_(t, lambda x: x % 2 == 1, remove_empty=False):
&lt;FastTreeValue 0x7fcfc96c8fd0 keys: [&#39;a&#39;, &#39;x&#39;, &#39;y&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7fcfc90b9a90 keys: [&#39;c&#39;]&gt;
│   └── &#39;c&#39; --&gt; 3
└── &#39;y&#39; --&gt; &lt;FastTreeValue 0x7fcfc96eb410 keys: []&gt;
</pre></div></td></tr></table></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Actually, the code above is equal to the code below. The <code class="docutils literal notranslate"><span class="pre">filter_</span></code> function can be seen as a combination of <code class="docutils literal notranslate"><span class="pre">mask</span></code> function and <code class="docutils literal notranslate"><span class="pre">mapping</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">mask</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mask(t, mapping(t, lambda x: x % 2 == 1)):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mask</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">mapping</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mask(t, mapping(t, lambda x: x % 2 == 1), remove_empty=False):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mask</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">mapping</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span> <span class="n">remove_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div></td></tr></table></div>
</div>
<p>The result should be like below, exactly the same as the code above.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span>mask(t, mapping(t, lambda x: x % 2 == 1)):
&lt;FastTreeValue 0x7fb400686ed0 keys: [&#39;a&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7fb400686b10 keys: [&#39;c&#39;]&gt;
    └── &#39;c&#39; --&gt; 3

mask(t, mapping(t, lambda x: x % 2 == 1), remove_empty=False):
&lt;FastTreeValue 0x7fb400691050 keys: [&#39;a&#39;, &#39;x&#39;, &#39;y&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7fb400672850 keys: [&#39;c&#39;]&gt;
│   └── &#39;c&#39; --&gt; 3
└── &#39;y&#39; --&gt; &lt;FastTreeValue 0x7fb400ca5610 keys: []&gt;
</pre></div></td></tr></table></div>
</div>
<p>For further information about <code class="docutils literal notranslate"><span class="pre">mask</span></code> function, take a look at <a class="reference internal" href="#tutorials-advancedusage-functional-mask"><span class="std std-ref">Mask</span></a>.</p>
</div>
<p>For further definition or source code implement of function <code class="docutils literal notranslate"><span class="pre">filter_</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-filter"><span class="std std-ref">filter_</span></a>.</p>
</div>
<div class="section" id="mask">
<span id="tutorials-advancedusage-functional-mask"></span><h3>Mask<a class="headerlink" href="#mask" title="Permalink to this headline">¶</a></h3>
<p>Mask function allow your choice in one tree, by another tree of true-or-false flags. A simple code example is</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">mask</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mask(t, m):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mask</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mask(t, m, remove_empty=False):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mask</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">remove_empty</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div></td></tr></table></div>
</div>
<p>The result will be like below, values mapped with the tree <code class="docutils literal notranslate"><span class="pre">m</span></code> which mask flag is <code class="docutils literal notranslate"><span class="pre">False</span></code> are all deleted. Also, <code class="docutils literal notranslate"><span class="pre">remove_empty</span></code> argument is supported.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span>mask(t, m):
&lt;FastTreeValue 0x7fc5c0fbf4d0 keys: [&#39;a&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7fc5c0fc5310 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    └── &#39;d&#39; --&gt; 4

mask(t, m, remove_empty=False):
&lt;FastTreeValue 0x7fc5c0f6f810 keys: [&#39;a&#39;, &#39;x&#39;, &#39;y&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7fc5c0f6f450 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
│   ├── &#39;c&#39; --&gt; 3
│   └── &#39;d&#39; --&gt; 4
└── &#39;y&#39; --&gt; &lt;FastTreeValue 0x7fc5c0f6f690 keys: []&gt;
</pre></div></td></tr></table></div>
</div>
<p>For further definition or source code implement of function <code class="docutils literal notranslate"><span class="pre">mask</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-mask"><span class="std std-ref">mask</span></a>.</p>
</div>
<div class="section" id="reduce">
<h3>Reduce<a class="headerlink" href="#reduce" title="Permalink to this headline">¶</a></h3>
<p>By using <code class="docutils literal notranslate"><span class="pre">reduce_</span></code> function, you can get some calculation result based on the tree structure. Its meaning is similar to primitive <code class="docutils literal notranslate"><span class="pre">reduce_</span></code> function, but its base structure is <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> instead of sequence or iterator. For example, we can get the sum and multiply accumulation of the values in the tree.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="fm">__mul__</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">reduce_</span><span class="p">,</span> <span class="n">FastTreeValue</span>


<span class="k">def</span> <span class="nf">multi</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="fm">__mul__</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum of t:&quot;</span><span class="p">,</span> <span class="n">reduce_</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Multiply of t:&quot;</span><span class="p">,</span> <span class="n">reduce_</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">multi</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
</pre></div></td></tr></table></div>
</div>
<p>The result should be like below.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span>Sum of t: 24
Multiply of t: 1152
</pre></div></td></tr></table></div>
</div>
<p>If we use <code class="docutils literal notranslate"><span class="pre">reduce_</span></code> function with <code class="docutils literal notranslate"><span class="pre">mapping</span></code> function, huffman weight sum can also be easily calculated with the code below.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">reduce_</span><span class="p">,</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">mapping</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>

    <span class="n">weights</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="n">v</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weight tree:&quot;</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Huffman weight sum of t:&quot;</span><span class="p">,</span>
          <span class="n">reduce_</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="k">lambda</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
</pre></div></td></tr></table></div>
</div>
<p>The result should be like below.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span>Weight tree: &lt;FastTreeValue 0x7fd5efc6eb90 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;, &#39;y&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
├── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7fd5efc6e6d0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
│   ├── &#39;c&#39; --&gt; 6
│   └── &#39;d&#39; --&gt; 8
└── &#39;y&#39; --&gt; &lt;FastTreeValue 0x7fd5efc6ed10 keys: [&#39;e&#39;, &#39;f&#39;]&gt;
    ├── &#39;e&#39; --&gt; 12
    └── &#39;f&#39; --&gt; 16

Huffman weight sum of t: 45
</pre></div></td></tr></table></div>
</div>
<p>Besides, we can easily calculate sum of the <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> objects’ bytes size, like the following code.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">reduce_</span><span class="p">,</span> <span class="n">FastTreeValue</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]),</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
            <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
        <span class="p">},</span>
    <span class="p">})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Size tree:&quot;</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">nbytes</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total bytes of arrays in t:&quot;</span><span class="p">,</span>
          <span class="n">reduce_</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">nbytes</span><span class="p">,</span> <span class="k">lambda</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
</pre></div></td></tr></table></div>
</div>
<p>The result should be like below.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span>Size tree: &lt;FastTreeValue 0x7f0cfe08ed10 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 72
├── &#39;b&#39; --&gt; 32
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f0cfe12ee50 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 32
    └── &#39;d&#39; --&gt; 48

Total bytes of arrays in t: 184
</pre></div></td></tr></table></div>
</div>
<p>For further definition or source code implement of function <code class="docutils literal notranslate"><span class="pre">reduce_</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-reduce"><span class="std std-ref">reduce_</span></a>.</p>
</div>
</div>
<div class="section" id="structural-utilities">
<h2>Structural Utilities<a class="headerlink" href="#structural-utilities" title="Permalink to this headline">¶</a></h2>
<p>In order to process some structured data, especially when you need to process a sort of <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> objects which is in the primitive collections or mappings, the structural utilities are designed, and they will be introduced in this section with examples.</p>
<div class="section" id="union">
<h3>Union<a class="headerlink" href="#union" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">union</span></code> function is similar to the primitive <code class="docutils literal notranslate"><span class="pre">zip</span></code> function some ways, it can combine a list of <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> objects as one <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> object which leaf values are tuples, like the simple example below.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">union</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">}})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">}})</span>
    <span class="n">t4</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;union(t1, t2):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">union</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;union(t1, t2, t3):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">union</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;union(t1, t2, t3, t4):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">union</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">,</span> <span class="n">t4</span><span class="p">))</span>
</pre></div></td></tr></table></div>
</div>
<p>The result should be like below, the leaf values are unionised as tuples.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span>union(t1, t2):
&lt;FastTreeValue 0x7f0ee43388d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; (1, 11)
├── &#39;b&#39; --&gt; (2, 22)
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f0ee48fb550 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; (3, 30)
    ├── &#39;d&#39; --&gt; (4, 48)
    └── &#39;e&#39; --&gt; (5, 54)

union(t1, t2, t3):
&lt;FastTreeValue 0x7f0ee43304d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; (1, 11, -13)
├── &#39;b&#39; --&gt; (2, 22, -7)
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f0ee42cc690 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; (3, 30, -5)
    ├── &#39;d&#39; --&gt; (4, 48, -3)
    └── &#39;e&#39; --&gt; (5, 54, -2)

union(t1, t2, t3, t4):
&lt;FastTreeValue 0x7f0ee42df1d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; (1, 11, -13, -13)
├── &#39;b&#39; --&gt; (2, 22, -7, -7)
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f0ee42df210 keys: [&#39;c&#39;, &#39;d&#39;, &#39;e&#39;]&gt;
    ├── &#39;c&#39; --&gt; (3, 30, -5, 8)
    ├── &#39;d&#39; --&gt; (4, 48, -3, 8)
    └── &#39;e&#39; --&gt; (5, 54, -2, 8)
</pre></div></td></tr></table></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In <code class="docutils literal notranslate"><span class="pre">union</span></code> function (actually <code class="docutils literal notranslate"><span class="pre">subside</span></code> function has the same property), all the trees to be unionised need to have the same structure. You can just consider it as strict mode with inheriting is enabled.</p>
</div>
<p>For further information and arguments of function <code class="docutils literal notranslate"><span class="pre">union</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-union"><span class="std std-ref">union</span></a>.</p>
</div>
<div class="section" id="subside">
<h3>Subside<a class="headerlink" href="#subside" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">subside</span></code> function can transform the collections or mapping nested <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> objects into one <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> object which leaf values has the dispatch’s structure. The <code class="docutils literal notranslate"><span class="pre">union</span></code> function mentioned above is also based on the <code class="docutils literal notranslate"><span class="pre">subside</span></code> function. Function <code class="docutils literal notranslate"><span class="pre">subside</span></code> will greatly simplify the code when the structured data need to be calculated. Just like this following example code.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">subside</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">}})</span>
    <span class="n">t4</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}})</span>
    <span class="n">t5</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">17</span><span class="p">}})</span>

    <span class="n">st</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">),</span> <span class="s1">&#39;second&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">t3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">t4</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">t5</span><span class="p">}]}</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;subside(st):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">subside</span><span class="p">(</span><span class="n">st</span><span class="p">))</span>
</pre></div></td></tr></table></div>
</div>
<p>The result should be like below, the leaf values are combined as the dispatch structure of <code class="docutils literal notranslate"><span class="pre">st</span></code>.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span>subside(st):
&lt;TreeValue 0x7fc5f957ee10 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; {&#39;first&#39;: (1, -14), &#39;second&#39;: [6, {&#39;x&#39;: 0, &#39;y&#39;: 3}]}
├── &#39;b&#39; --&gt; {&#39;first&#39;: (2, 9), &#39;second&#39;: [0, {&#39;x&#39;: -17, &#39;y&#39;: 9}]}
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fc5f963c850 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; {&#39;first&#39;: (3, 3), &#39;second&#39;: [-5, {&#39;x&#39;: -8, &#39;y&#39;: 11}]}
    └── &#39;d&#39; --&gt; {&#39;first&#39;: (4, 8), &#39;second&#39;: [17, {&#39;x&#39;: 15, &#39;y&#39;: -17}]}
</pre></div></td></tr></table></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In function <code class="docutils literal notranslate"><span class="pre">subside</span></code>, only primitive list, tuple and dict (or subclasses) objects will be subsided to leaf values.</p>
</div>
<p>For further information and arguments of function <code class="docutils literal notranslate"><span class="pre">subside</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-subside"><span class="std std-ref">subside</span></a>.</p>
</div>
<div class="section" id="rise">
<h3>Rise<a class="headerlink" href="#rise" title="Permalink to this headline">¶</a></h3>
<p>Function <code class="docutils literal notranslate"><span class="pre">rise</span></code> can be seen as the inverse operation of function <code class="docutils literal notranslate"><span class="pre">subside</span></code>, it will try to extract the greatest common structure of the leaf values, and rise them up to the dispatch above the <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> objects. Like the following example code.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">subside</span><span class="p">,</span> <span class="n">rise</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># The same demo as the subside docs</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">}})</span>
    <span class="n">t4</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}})</span>
    <span class="n">t5</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">17</span><span class="p">}})</span>
    <span class="n">st</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">),</span> <span class="s1">&#39;second&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">t3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">t4</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">t5</span><span class="p">})}</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">subside</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>

    <span class="c1"># Rising process</span>
    <span class="n">st2</span> <span class="o">=</span> <span class="n">rise</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">st2</span> <span class="o">==</span> <span class="n">st</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;st2:&#39;</span><span class="p">,</span> <span class="n">st2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;first&#39;][0]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;first&#39;][1]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;second&#39;][0]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;second&#39;][1][&#39;x&#39;]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;second&#39;][1][&#39;y&#39;]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
</pre></div></td></tr></table></div>
</div>
<p>The result should be like below, the subsided tree <code class="docutils literal notranslate"><span class="pre">st</span></code> can be extract back to the original structure.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span>st2: {&#39;first&#39;: (&lt;TreeValue 0x7fc316937290 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;, &lt;TreeValue 0x7fc3169375d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;), &#39;second&#39;: (&lt;TreeValue 0x7fc3169378d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;, {&#39;x&#39;: &lt;TreeValue 0x7fc316937bd0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;, &#39;y&#39;: &lt;TreeValue 0x7fc316929250 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;})}
st2[&#39;first&#39;][0]:
&lt;TreeValue 0x7fc316937290 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fc316929f50 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    └── &#39;d&#39; --&gt; 4

st2[&#39;first&#39;][1]:
&lt;TreeValue 0x7fc3169375d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; -14
├── &#39;b&#39; --&gt; 9
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fc316937490 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    └── &#39;d&#39; --&gt; 8

st2[&#39;second&#39;][0]:
&lt;TreeValue 0x7fc3169378d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 6
├── &#39;b&#39; --&gt; 0
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fc316937790 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; -5
    └── &#39;d&#39; --&gt; 17

st2[&#39;second&#39;][1][&#39;x&#39;]:
&lt;TreeValue 0x7fc316937bd0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 0
├── &#39;b&#39; --&gt; -17
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fc316937a90 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; -8
    └── &#39;d&#39; --&gt; 15

st2[&#39;second&#39;][1][&#39;y&#39;]:
&lt;TreeValue 0x7fc316929250 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 3
├── &#39;b&#39; --&gt; 9
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fc31697e410 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 11
    └── &#39;d&#39; --&gt; -17
</pre></div></td></tr></table></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In function <code class="docutils literal notranslate"><span class="pre">rise</span></code>, only primitive list, tuple and dict (or subclasses) objects will join the rising operation.</p>
<p>Actually, when <code class="docutils literal notranslate"><span class="pre">template</span></code> argument is not assigned, the <code class="docutils literal notranslate"><span class="pre">rise</span></code> function will try to find the greatest common structure and rise them to the dispatch. The following rules will be strictly followed when doing this:</p>
<ul class="simple">
<li><p>If the values in current level have the same type ( must all be list, all be tuple or all be dict), the rising function will carry on the find sub structure, otherwise values in current level will be treated as atomic values.</p></li>
<li><p>If all of them are dicts, and they have exactly the same key sets with each other, the finding of sub structures will be carried on, otherwise these dicts will be treated as atomic values.</p></li>
<li><p>If all of them are lists, and they have the same length with each other, the finding of sub structures will be carried on, otherwise these dicts will be treated as atomic values.</p></li>
<li><p>If all of them are tuples, and they have the same length with each other, the finding of sub structures will be carried on, otherwise these dicts will be treated as atomic values. (Actually, this rule is the same as the last one which is about lists.)</p></li>
</ul>
<p>Considering this automatic structure finding process, if you only want to extract some of the structure (make sure the extraction will not be too deep or too shallow, and make sure the result will have the same structure as your expectation), you can assign value in <code class="docutils literal notranslate"><span class="pre">template</span></code> arguments. Like the example code below.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">subside</span><span class="p">,</span> <span class="n">rise</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># The same demo as the subside docs</span>
    <span class="n">t11</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t12</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">41</span><span class="p">}})</span>
    <span class="n">t21</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>
    <span class="n">t22</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">31</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">82</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">47</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">}})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">}})</span>
    <span class="n">t4</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}})</span>
    <span class="n">t5</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">17</span><span class="p">}})</span>
    <span class="n">st</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="n">t11</span><span class="p">,</span> <span class="n">t21</span><span class="p">),</span> <span class="p">(</span><span class="n">t12</span><span class="p">,</span> <span class="n">t22</span><span class="p">)],</span> <span class="s1">&#39;second&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">t3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">t4</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">t5</span><span class="p">})}</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">subside</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>

    <span class="c1"># Rising process, with template</span>
    <span class="c1"># only the top-leveled dict will be extracted,</span>
    <span class="c1"># neither tuple, list nor low-leveled dict will not be extracted</span>
    <span class="c1"># because they are not defined in `template` argument</span>
    <span class="n">st2</span> <span class="o">=</span> <span class="n">rise</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">],</span> <span class="s1">&#39;second&#39;</span><span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)})</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;st2:&#39;</span><span class="p">,</span> <span class="n">st2</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;first&#39;][0]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;first&#39;][1]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;second&#39;][0]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;st2[&#39;second&#39;][1]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</pre></div></td></tr></table></div>
</div>
<p>The result should be like below, the subsided tree <code class="docutils literal notranslate"><span class="pre">st</span></code> can be extract back to the structure of dict with only <code class="docutils literal notranslate"><span class="pre">first</span></code> and <code class="docutils literal notranslate"><span class="pre">second</span></code> keys.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span>st2: {&#39;first&#39;: [&lt;TreeValue 0x7f6e19f14a90 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;, &lt;TreeValue 0x7f6e19f14e50 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;], &#39;second&#39;: (&lt;TreeValue 0x7f6e19f14e10 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;, &lt;TreeValue 0x7f6e19f14710 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;)}
st2[&#39;first&#39;][0]:
&lt;TreeValue 0x7f6e19f14a90 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; (1, -14)
├── &#39;b&#39; --&gt; (2, 9)
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f6e19f14390 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; (3, 3)
    └── &#39;d&#39; --&gt; (4, 8)

st2[&#39;first&#39;][1]:
&lt;TreeValue 0x7f6e19f14e50 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; (3, -31)
├── &#39;b&#39; --&gt; (9, 82)
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f6e19f14d10 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; (15, 47)
    └── &#39;d&#39; --&gt; (41, 32)

st2[&#39;second&#39;][0]:
&lt;TreeValue 0x7f6e19f14e10 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 6
├── &#39;b&#39; --&gt; 0
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f6e19f5e350 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; -5
    └── &#39;d&#39; --&gt; 17

st2[&#39;second&#39;][1]:
&lt;TreeValue 0x7f6e19f14710 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; {&#39;x&#39;: 0, &#39;y&#39;: 3}
├── &#39;b&#39; --&gt; {&#39;x&#39;: -17, &#39;y&#39;: 9}
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f6e19f14bd0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; {&#39;x&#39;: -8, &#39;y&#39;: 11}
    └── &#39;d&#39; --&gt; {&#39;x&#39;: 15, &#39;y&#39;: -17}
</pre></div></td></tr></table></div>
</div>
</div>
<p>For further information and arguments of function <code class="docutils literal notranslate"><span class="pre">rise</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-rise"><span class="std std-ref">rise</span></a>.</p>
</div>
</div>
<div class="section" id="tree-utilities">
<h2>Tree Utilities<a class="headerlink" href="#tree-utilities" title="Permalink to this headline">¶</a></h2>
<p>In this section, utilities with <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> class and its objects themselves will be introduced with examples.</p>
<div class="section" id="jsonify">
<h3>Jsonify<a class="headerlink" href="#jsonify" title="Permalink to this headline">¶</a></h3>
<p>With the usage of <code class="docutils literal notranslate"><span class="pre">jsonify</span></code> function, you can transform a <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> object to json-formatted data.</p>
<p>For example, the following real code</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">raw</span><span class="p">,</span> <span class="n">jsonify</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">raw</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}),</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="s2">&quot;this is a string&quot;</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tree t:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Json data of t:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">jsonify</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div></td></tr></table></div>
</div>
<p>The result should be</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span>Tree t:
&lt;TreeValue 0x7efd59f38690 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; [2, 3]
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7efd59a217d0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; {&#39;x&#39;: 1, &#39;y&#39;: 2}
    └── &#39;d&#39; --&gt; &#39;this is a string&#39;

Json data of t:
{
    &quot;a&quot;: 1,
    &quot;b&quot;: [
        2,
        3
    ],
    &quot;x&quot;: {
        &quot;c&quot;: {
            &quot;x&quot;: 1,
            &quot;y&quot;: 2
        },
        &quot;d&quot;: &quot;this is a string&quot;
    }
}
</pre></div></td></tr></table></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">raw</span></code> in the example code above is a wrapper for dictionary object. It can be used to pass <code class="docutils literal notranslate"><span class="pre">dict</span></code> object as simple value in <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> instead of being treated as sub tree.</p>
<p>For further information of function <code class="docutils literal notranslate"><span class="pre">raw</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/common.html#apidoc-tree-common-raw"><span class="std std-ref">raw</span></a>.</p>
</div>
<p>For further informaon of function <code class="docutils literal notranslate"><span class="pre">jsonify</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-jsonify"><span class="std std-ref">jsonify</span></a>.</p>
</div>
<div class="section" id="view">
<h3>View<a class="headerlink" href="#view" title="Permalink to this headline">¶</a></h3>
<p>Another magic function named <code class="docutils literal notranslate"><span class="pre">view</span></code> is also provided, to process logic viewing cases.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">view</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tree t:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="n">t_x_y</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">y</span>
    <span class="n">vt_x_y</span> <span class="o">=</span> <span class="n">view</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;t.x.y:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t_x_y</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;View of t, [&#39;x&#39;, &#39;y&#39;]:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">vt_x_y</span><span class="p">)</span>

    <span class="n">t</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;cc&#39;</span><span class="p">:</span> <span class="mi">33</span><span class="p">,</span> <span class="s1">&#39;dd&#39;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ee&#39;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span> <span class="s1">&#39;ff&#39;</span><span class="p">:</span> <span class="mi">66</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;t_x_y after replacement:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t_x_y</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;View of t, [&#39;x&#39;, &#39;y&#39;] after replacement:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">vt_x_y</span><span class="p">)</span>
</pre></div></td></tr></table></div>
</div>
<p>The result will be like below, <code class="docutils literal notranslate"><span class="pre">t_x_y</span></code> and <code class="docutils literal notranslate"><span class="pre">vt_x_y</span></code>’s value is different after the replacement of the sub tree named <code class="docutils literal notranslate"><span class="pre">t.x</span></code>, for <code class="docutils literal notranslate"><span class="pre">vt_x_y</span></code>’s value’s equality to the current <code class="docutils literal notranslate"><span class="pre">t.x.y</span></code>.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span>Tree t:
&lt;TreeValue 0x7f654df977d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f654df97750 keys: [&#39;c&#39;, &#39;d&#39;, &#39;y&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    ├── &#39;d&#39; --&gt; 4
    └── &#39;y&#39; --&gt; &lt;TreeValue 0x7f654df97610 keys: [&#39;e&#39;, &#39;f&#39;]&gt;
        ├── &#39;e&#39; --&gt; 5
        └── &#39;f&#39; --&gt; 6

t.x.y:
&lt;TreeValue 0x7f654df97610 keys: [&#39;e&#39;, &#39;f&#39;]&gt;
├── &#39;e&#39; --&gt; 5
└── &#39;f&#39; --&gt; 6

View of t, [&#39;x&#39;, &#39;y&#39;]:
&lt;TreeValue 0x7f654df97610 keys: [&#39;e&#39;, &#39;f&#39;]&gt;
├── &#39;e&#39; --&gt; 5
└── &#39;f&#39; --&gt; 6

t_x_y after replacement:
&lt;TreeValue 0x7f654df97610 keys: [&#39;e&#39;, &#39;f&#39;]&gt;
├── &#39;e&#39; --&gt; 5
└── &#39;f&#39; --&gt; 6

View of t, [&#39;x&#39;, &#39;y&#39;] after replacement:
&lt;TreeValue 0x7f654d964ad0 keys: [&#39;ee&#39;, &#39;ff&#39;]&gt;
├── &#39;ee&#39; --&gt; 55
└── &#39;ff&#39; --&gt; 66
</pre></div></td></tr></table></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Attention that the <code class="docutils literal notranslate"><span class="pre">view</span></code> operation is different from sub node getting operation. In viewed tree, it is based on a logic link based on the tree be viewed, and the actual operations are performed in the actual tree node. The main difference between <code class="docutils literal notranslate"><span class="pre">view</span></code> and getting sub node is that the view tree will be affected by the replacement of sub nodes in viewed tree.</p>
<p>Like the code example above, in the view tree <code class="docutils literal notranslate"><span class="pre">vt_x_y</span></code>, before do tree operations, the viewed tree will be approached from root tree <code class="docutils literal notranslate"><span class="pre">t</span></code> by keys of <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>, so after the replacement of the whole subtree <code class="docutils literal notranslate"><span class="pre">t.x</span></code>, <code class="docutils literal notranslate"><span class="pre">vt_x_y</span></code> is still the latest value of <code class="docutils literal notranslate"><span class="pre">t.x.y</span></code>, while <code class="docutils literal notranslate"><span class="pre">t_x_y</span></code> is still the old sub tree of tree <code class="docutils literal notranslate"><span class="pre">t</span></code>, before replacement.</p>
</div>
<p>For further informaon of function <code class="docutils literal notranslate"><span class="pre">view</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-view"><span class="std std-ref">view</span></a>.</p>
</div>
<div class="section" id="clone">
<h3>Clone<a class="headerlink" href="#clone" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> objects can be cloned deeply by <code class="docutils literal notranslate"><span class="pre">clone</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">clone</span><span class="p">,</span> <span class="n">raw</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">raw</span><span class="p">({</span><span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">})}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tree t:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Id of t.x.y: </span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">id</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;clone(t):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">clone</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Id of clone(t).x.y: </span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">id</span><span class="p">(</span><span class="n">clone</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;clone(t, copy_value=True):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">clone</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">copy_value</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Id of clone(t, copy_value=True).x.y: </span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">id</span><span class="p">(</span><span class="n">clone</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">copy_value</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div></td></tr></table></div>
</div>
<p>The result will be like below, all the memory address of the tree nodes in cloned tree are different from those in the original tree <code class="docutils literal notranslate"><span class="pre">t</span></code> when <code class="docutils literal notranslate"><span class="pre">copy_value</span></code> argument is not set. But when <code class="docutils literal notranslate"><span class="pre">copy_value</span></code> is assigned as <code class="docutils literal notranslate"><span class="pre">True</span></code>, the address of values will be changed because of the deep copy of value.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span>Tree t:
&lt;TreeValue 0x7f9b078d76d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f9b073c07d0 keys: [&#39;c&#39;, &#39;d&#39;, &#39;y&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    ├── &#39;d&#39; --&gt; 4
    └── &#39;y&#39; --&gt; {&#39;e&#39;: 5, &#39;f&#39;: 6}

Id of t.x.y: 7f9b081b8c30


clone(t):
&lt;TreeValue 0x7f9b072a4dd0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f9b07444bd0 keys: [&#39;c&#39;, &#39;d&#39;, &#39;y&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    ├── &#39;d&#39; --&gt; 4
    └── &#39;y&#39; --&gt; {&#39;e&#39;: 5, &#39;f&#39;: 6}

Id of clone(t).x.y: 7f9b081b8c30


clone(t, copy_value=True):
&lt;TreeValue 0x7f9b0731bc50 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f9b0731bd10 keys: [&#39;c&#39;, &#39;d&#39;, &#39;y&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    ├── &#39;d&#39; --&gt; 4
    └── &#39;y&#39; --&gt; {&#39;e&#39;: 5, &#39;f&#39;: 6}

Id of clone(t, copy_value=True).x.y: 7f9b07318b10
</pre></div></td></tr></table></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Attention that in function <code class="docutils literal notranslate"><span class="pre">clone</span></code>, the values will not be deeply copied together with the tree nodes by default. <strong>The newly cloned tree’s values have the same memory address with those in original tree</strong>.</p>
<p>If deep copy of values is required when using <code class="docutils literal notranslate"><span class="pre">clone</span></code>, <code class="docutils literal notranslate"><span class="pre">copy_value</span></code> argument need to be assigned as <code class="docutils literal notranslate"><span class="pre">True</span></code>. And then a <code class="docutils literal notranslate"><span class="pre">copy.deepcopy</span></code> will be performed in <code class="docutils literal notranslate"><span class="pre">clone</span></code> function in order to do the deep copy. Also, you can define your own copy function in <code class="docutils literal notranslate"><span class="pre">copy_value</span></code> argument by just assign it as a lambda expression like <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">pickle.loads(pickle.dumps(x))</span></code>.</p>
</div>
<p>For further informaon of function <code class="docutils literal notranslate"><span class="pre">clone</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-clone"><span class="std std-ref">clone</span></a>.</p>
</div>
<div class="section" id="typetrans">
<h3>Typetrans<a class="headerlink" href="#typetrans" title="Permalink to this headline">¶</a></h3>
<p>You can use function <code class="docutils literal notranslate"><span class="pre">typetrans</span></code> to change the type of tree value object, just like the example below.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">method_treelize</span><span class="p">,</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">typetrans</span>


<span class="k">class</span> <span class="nc">MyTreeValue</span><span class="p">(</span><span class="n">TreeValue</span><span class="p">):</span>
    <span class="nd">@method_treelize</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">pw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1 ** 2:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t1</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># Transform t1 to MyTreeValue,</span>
    <span class="c1"># __pow__ operator will be disabled and pw method will be enabled.</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">typetrans</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">MyTreeValue</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t2:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t2.pw():&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">pw</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div></td></tr></table></div>
</div>
<p>The result will be like below. After the type transformation, <code class="docutils literal notranslate"><span class="pre">**</span></code> operator can not be used in <code class="docutils literal notranslate"><span class="pre">t2</span></code> but method <code class="docutils literal notranslate"><span class="pre">pw</span></code> which is implemented in <code class="docutils literal notranslate"><span class="pre">MyTreeValue</span></code> will be enabled.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span>t1:
&lt;FastTreeValue 0x7f225df77790 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f225df80250 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    └── &#39;d&#39; --&gt; 4

t1 ** 2:
&lt;FastTreeValue 0x7f225dd618d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 4
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f225dcbba10 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 9
    └── &#39;d&#39; --&gt; 16


t2:
&lt;MyTreeValue 0x7f225df77790 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7f225df80250 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    └── &#39;d&#39; --&gt; 4

t2.pw():
&lt;MyTreeValue 0x7f225dcbbf10 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 6
├── &#39;b&#39; --&gt; 12
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7f225dcb3e10 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 20
    └── &#39;d&#39; --&gt; 30
</pre></div></td></tr></table></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In treevalue library, there can be more classes based on <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> class by your definition.</p>
<p>Different tree value class will have the different operators, methods and class methods for service, and the <code class="docutils literal notranslate"><span class="pre">__eq__</span></code> operator’s result between different type of tree values will always be <code class="docutils literal notranslate"><span class="pre">False</span></code> because of the difference of their types.</p>
<p>For further information of <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> class and user’s definition practice, just take a look at:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-treevalue"><span class="std std-ref">API documentation of TreeValue</span></a>.</p></li>
<li><p><a class="reference internal" href="../../api_doc/tree/general.html#apidoc-tree-general-fasttreevalue"><span class="std std-ref">API documentation of FastTreeValue</span></a>.</p></li>
<li><p><a class="reference internal" href="#tutorials-advancedusage-diy"><span class="std std-ref">DIY TreeValue Class</span></a>.</p></li>
</ul>
</div>
<p>For further informaon of function <code class="docutils literal notranslate"><span class="pre">typetrans</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-typetrans"><span class="std std-ref">typetrans</span></a>.</p>
</div>
</div>
<div class="section" id="io-utilities">
<h2>IO Utilities<a class="headerlink" href="#io-utilities" title="Permalink to this headline">¶</a></h2>
<div class="section" id="simple-serialize-and-deserialize">
<h3>Simple Serialize and Deserialize<a class="headerlink" href="#simple-serialize-and-deserialize" title="Permalink to this headline">¶</a></h3>
<p>In this version, <code class="docutils literal notranslate"><span class="pre">pickle.dumps</span></code> and <code class="docutils literal notranslate"><span class="pre">pickle.loads</span></code> operations are supported, just like the code below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]}})</span>
    <span class="n">binary</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

    <span class="n">tx</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">tx</span> <span class="o">==</span> <span class="n">t</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;tx:&#39;</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
</pre></div>
</div>
<p>The output is</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>t:
&lt;TreeValue 0x7fe69eafca10 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fe69e5e5810 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    └── &#39;d&#39; --&gt; [3, 4]

tx:
&lt;TreeValue 0x7fe69e4cadd0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7fe69e4ca1d0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    └── &#39;d&#39; --&gt; [3, 4]
</pre></div>
</div>
</div>
<div class="section" id="advanced-dump-and-load">
<h3>Advanced Dump and Load<a class="headerlink" href="#advanced-dump-and-load" title="Permalink to this headline">¶</a></h3>
<p>In this project, we implemented our <code class="docutils literal notranslate"><span class="pre">load</span></code> and <code class="docutils literal notranslate"><span class="pre">dump</span></code> function which can be used like this</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">tempfile</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">dump</span><span class="p">,</span> <span class="n">load</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;ab&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;Cd&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;eF&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="s1">&#39;GH&#39;</span><span class="p">}})</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">()</span> <span class="k">as</span> <span class="n">tf</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">wf</span><span class="p">:</span>  <span class="c1"># dump t to file</span>
            <span class="n">dump</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">wf</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">rf</span><span class="p">:</span>  <span class="c1"># load dt from file</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">rf</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">dt</span> <span class="o">==</span> <span class="n">t</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dt:&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
</pre></div>
</div>
<p>The output should be</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>t:
&lt;TreeValue 0x7f3306e72bd0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; &#39;ab&#39;
├── &#39;b&#39; --&gt; &#39;Cd&#39;
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f3306e72690 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; &#39;eF&#39;
    └── &#39;d&#39; --&gt; &#39;GH&#39;

dt:
&lt;TreeValue 0x7f3306b71990 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; &#39;ab&#39;
├── &#39;b&#39; --&gt; &#39;Cd&#39;
└── &#39;x&#39; --&gt; &lt;TreeValue 0x7f330683ffd0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; &#39;eF&#39;
    └── &#39;d&#39; --&gt; &#39;GH&#39;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this <code class="docutils literal notranslate"><span class="pre">load</span></code> (<code class="docutils literal notranslate"><span class="pre">loads</span></code> function is the same), you must assign a <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> class by the <code class="docutils literal notranslate"><span class="pre">type_</span></code> argument because the dumped data will not save the type of trees. When the type is not assigned, the default class will be simply <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code>.</p>
</div>
<p>Also, <code class="docutils literal notranslate"><span class="pre">dumps</span></code> function and <code class="docutils literal notranslate"><span class="pre">loads</span></code> function are provided to deal with binary data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">loads</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;ab&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;Cd&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;eF&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="s1">&#39;GH&#39;</span><span class="p">}})</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t:&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

    <span class="n">binary</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="n">FastTreeValue</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">dt</span> <span class="o">==</span> <span class="n">t</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dt:&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
</pre></div>
</div>
<p>The output should be</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>t:
&lt;FastTreeValue 0x7fb3569d8a10 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; &#39;ab&#39;
├── &#39;b&#39; --&gt; &#39;Cd&#39;
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7fb3569d84d0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; &#39;eF&#39;
    └── &#39;d&#39; --&gt; &#39;GH&#39;

dt:
&lt;FastTreeValue 0x7fb3569d87d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; &#39;ab&#39;
├── &#39;b&#39; --&gt; &#39;Cd&#39;
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7fb3563a6d90 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; &#39;eF&#39;
    └── &#39;d&#39; --&gt; &#39;GH&#39;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The main differences between our <code class="docutils literal notranslate"><span class="pre">dump</span></code> / <code class="docutils literal notranslate"><span class="pre">load</span></code> and <code class="docutils literal notranslate"><span class="pre">pickle</span></code> ‘s <code class="docutils literal notranslate"><span class="pre">dump</span></code> / <code class="docutils literal notranslate"><span class="pre">load</span></code> are:</p>
<ul class="simple">
<li><p>Ours are based on <a class="reference external" href="https://github.com/uqfoundation/dill">dill</a> project, it can serialize and deserialize more types than native <code class="docutils literal notranslate"><span class="pre">pickle</span></code>, such as functions and classes.</p></li>
<li><p>Compression and decompression can be defined when dumping, and when the compressed binary data is going to be loaded, decompression function is not necessary, the decompression can be carried on with the function defined in dumping process.</p></li>
</ul>
<p>Here is an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gzip</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;ab&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;Cd&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;eF&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="s1">&#39;GH&#39;</span><span class="p">}})</span>
    <span class="n">st</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">upper</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;st:&#39;</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>  <span class="c1"># st is a function tree</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;st():&#39;</span><span class="p">,</span> <span class="n">st</span><span class="p">(),</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>  <span class="c1"># st() if an upper-case-string tree</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="n">binary</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="p">(</span><span class="n">gzip</span><span class="o">.</span><span class="n">compress</span><span class="p">,</span> <span class="n">gzip</span><span class="o">.</span><span class="n">decompress</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Length of binary:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">binary</span><span class="p">))</span>

    <span class="c1"># compression function is not needed here</span>
    <span class="n">dst</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="n">FastTreeValue</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dst:&#39;</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">st</span><span class="p">()</span> <span class="o">==</span> <span class="n">dst</span><span class="p">()</span>  <span class="c1"># st() should be equal to dst()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dst():&#39;</span><span class="p">,</span> <span class="n">dst</span><span class="p">(),</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
</pre></div>
</div>
<p>The output should be</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>st:
&lt;FastTreeValue 0x7f2a2f015bd0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; &lt;built-in method upper of str object at 0x7f2a2fca33f0&gt;
├── &#39;b&#39; --&gt; &lt;built-in method upper of str object at 0x7f2a2fe6fe70&gt;
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f2a2f137410 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; &lt;built-in method upper of str object at 0x7f2a2fe59330&gt;
    └── &#39;d&#39; --&gt; &lt;built-in method upper of str object at 0x7f2a2fcfe730&gt;

st():
&lt;FastTreeValue 0x7f2a2f00f450 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; &#39;AB&#39;
├── &#39;b&#39; --&gt; &#39;CD&#39;
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f2a2f08be90 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; &#39;EF&#39;
    └── &#39;d&#39; --&gt; &#39;GH&#39;


Length of binary: 228
dst:
&lt;FastTreeValue 0x7f2a2f084c10 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; &lt;built-in method upper of str object at 0x7f2a2f0848f0&gt;
├── &#39;b&#39; --&gt; &lt;built-in method upper of str object at 0x7f2a2f084630&gt;
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f2a2f088790 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; &lt;built-in method upper of str object at 0x7f2a2f0842b0&gt;
    └── &#39;d&#39; --&gt; &lt;built-in method upper of str object at 0x7f2a2f0840f0&gt;

dst():
&lt;FastTreeValue 0x7f2a2f037710 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; &#39;AB&#39;
├── &#39;b&#39; --&gt; &#39;CD&#39;
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f2a2f037810 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; &#39;EF&#39;
    └── &#39;d&#39; --&gt; &#39;GH&#39;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="object-oriented-usage">
<h2>Object Oriented Usage<a class="headerlink" href="#object-oriented-usage" title="Permalink to this headline">¶</a></h2>
<p>In <code class="docutils literal notranslate"><span class="pre">FastTreeValue</span></code> class, plenty of object-oriented operators, methods and classmethods are supported in order to simplify the actual usage. Here is a simple code example.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>

    <span class="c1"># operator support</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1 + t2:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t1</span> <span class="o">+</span> <span class="n">t2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t2 ** t1:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t2</span> <span class="o">**</span> <span class="n">t1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># utilities support</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1.map(lambda x: (x + 1) * (x + 2)):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1.reduce(lambda **kwargs: sum(kwargs.values())):&#39;</span><span class="p">,</span>
          <span class="n">t1</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># linking usage</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1.map(lambda x: (x + 1) * (x + 2)).filter(lambda x: x % 4 == 0):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># structural support</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Union result:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">FastTreeValue</span><span class="o">.</span><span class="n">union</span><span class="p">(</span>
        <span class="n">t1</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)),</span>
        <span class="n">t2</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)),</span>
    <span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;first: </span><span class="si">%d</span><span class="s1">, second: </span><span class="si">%d</span><span class="s1">, which sum is </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">))))</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div></td></tr></table></div>
</div>
<p>The result should be like below.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span>t1 + t2:
&lt;FastTreeValue 0x7f3ea1a61b90 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 6
├── &#39;b&#39; --&gt; 8
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f3ea19bea10 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 10
    └── &#39;d&#39; --&gt; 12

t2 ** t1:
&lt;FastTreeValue 0x7f3ea19b6a50 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 5
├── &#39;b&#39; --&gt; 36
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f3ea19b3ed0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 343
    └── &#39;d&#39; --&gt; 4096


t1.map(lambda x: (x + 1) * (x + 2)):
&lt;FastTreeValue 0x7f3ea195b590 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 6
├── &#39;b&#39; --&gt; 12
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f3ea195b5d0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 20
    └── &#39;d&#39; --&gt; 30

t1.reduce(lambda **kwargs: sum(kwargs.values())): 10


t1.map(lambda x: (x + 1) * (x + 2)).filter(lambda x: x % 4 == 0):
&lt;FastTreeValue 0x7f3ea1964610 keys: [&#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;b&#39; --&gt; 12
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f3ea1964490 keys: [&#39;c&#39;]&gt;
    └── &#39;c&#39; --&gt; 20


Union result:
&lt;FastTreeValue 0x7f3ea19ad950 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; &#39;first: 6, second: 81, which sum is 87&#39;
├── &#39;b&#39; --&gt; &#39;first: 12, second: 1024, which sum is 1036&#39;
└── &#39;x&#39; --&gt; &lt;FastTreeValue 0x7f3ea19c1e10 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; &#39;first: 20, second: 15625, which sum is 15645&#39;
    └── &#39;d&#39; --&gt; &#39;first: 30, second: 279936, which sum is 279966&#39;
</pre></div></td></tr></table></div>
</div>
<p>For further information of <code class="docutils literal notranslate"><span class="pre">FastTreeValue</span></code> class, take a look at <a class="reference internal" href="../../api_doc/tree/general.html#apidoc-tree-general-fasttreevalue"><span class="std std-ref">FastTreeValue</span></a>, all the supported methods and operators are listed here.</p>
</div>
<div class="section" id="diy-treevalue-class">
<span id="tutorials-advancedusage-diy"></span><h2>DIY TreeValue Class<a class="headerlink" href="#diy-treevalue-class" title="Permalink to this headline">¶</a></h2>
<p>You can define your own <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> class with your own method and class methods. Like the example code below.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">classmethod_treelize</span><span class="p">,</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">method_treelize</span>


<span class="k">class</span> <span class="nc">MyTreeValue</span><span class="p">(</span><span class="n">TreeValue</span><span class="p">):</span>
    <span class="c1"># return type will be automatically detected as `MyTreeValue`</span>
    <span class="nd">@method_treelize</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Append arguments:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">b</span>

    <span class="c1"># return type will be automatically detected as `MyTreeValue`</span>
    <span class="nd">@classmethod</span>
    <span class="nd">@classmethod_treelize</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum arguments:&quot;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">MyTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1.append(t2).append(t3):&#39;</span><span class="p">,</span>
          <span class="n">t1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t3</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MyTreeValue.sum(t1, t2, t3):&#39;</span><span class="p">,</span>
          <span class="n">MyTreeValue</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
</pre></div></td></tr></table></div>
</div>
<p>The result should be like below.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span>Append arguments: 1 -14
Append arguments: 2 9
Append arguments: 3 3
Append arguments: 4 8
Append arguments: -13 6
Append arguments: 11 0
Append arguments: 6 -5
Append arguments: 12 17
t1.append(t2).append(t3):
&lt;MyTreeValue 0x7f11de0c2e10 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; -7
├── &#39;b&#39; --&gt; 11
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7f11de0c25d0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 1
    └── &#39;d&#39; --&gt; 29

Sum arguments: &lt;class &#39;__main__.MyTreeValue&#39;&gt; 1 -14 6
Sum arguments: &lt;class &#39;__main__.MyTreeValue&#39;&gt; 2 9 0
Sum arguments: &lt;class &#39;__main__.MyTreeValue&#39;&gt; 3 3 -5
Sum arguments: &lt;class &#39;__main__.MyTreeValue&#39;&gt; 4 8 17
MyTreeValue.sum(t1, t2, t3):
&lt;MyTreeValue 0x7f11de05f6d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; -7
├── &#39;b&#39; --&gt; 11
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7f11de06f110 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 1
    └── &#39;d&#39; --&gt; 29
</pre></div></td></tr></table></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Actually, self-calculation method can be defined like the code below</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">TreeValue</span><span class="p">,</span> <span class="n">method_treelize</span>


<span class="k">class</span> <span class="nc">MyTreeValue</span><span class="p">(</span><span class="n">TreeValue</span><span class="p">):</span>
    <span class="c1"># return type will be automatically detected as `MyTreeValue`</span>
    <span class="nd">@method_treelize</span><span class="p">(</span><span class="n">self_copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">MyTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1:&#39;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
    <span class="n">_t1_id</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1.append(t2).append(t3):&#39;</span><span class="p">,</span>
          <span class="n">t1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t3</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">id</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span> <span class="o">==</span> <span class="n">_t1_id</span>
</pre></div>
</div>
<p>The result should be</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>t1:
&lt;MyTreeValue 0x7fc417b79f90 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 1
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7fc417eb4190 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 3
    └── &#39;d&#39; --&gt; 4

t1.append(t2).append(t3):
&lt;MyTreeValue 0x7fc417b79f90 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; -7
├── &#39;b&#39; --&gt; 11
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7fc417eb4190 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 1
    └── &#39;d&#39; --&gt; 29
</pre></div>
</div>
<p>We can see that the calculation result will replace the <code class="docutils literal notranslate"><span class="pre">self</span></code> object, without changes of the address. Just enable the <code class="docutils literal notranslate"><span class="pre">self_copy</span></code> option is okay.</p>
</div>
<p>For further information of function <code class="docutils literal notranslate"><span class="pre">method_treelize</span></code> and <code class="docutils literal notranslate"><span class="pre">classmethod_treelize</span></code>, just take a look at:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../api_doc/tree/func.html#apidoc-tree-func-methodtreelize"><span class="std std-ref">method_treelize</span></a></p></li>
<li><p><a class="reference internal" href="../../api_doc/tree/func.html#apidoc-tree-func-classmethodtreelize"><span class="std std-ref">classmethod_treelize</span></a></p></li>
</ul>
</div>
<div class="section" id="more-flexible-ways-to-diy-class">
<h2>More Flexible Ways to DIY Class<a class="headerlink" href="#more-flexible-ways-to-diy-class" title="Permalink to this headline">¶</a></h2>
<p>When you implement <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> class like the section above (take a look at here <a class="reference internal" href="#tutorials-advancedusage-diy"><span class="std std-ref">DIY TreeValue Class</span></a>), you have to define your own methods and operators one by one, because in class <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code>, only the minimum necessary methods and operators are provided. But when you use <code class="docutils literal notranslate"><span class="pre">FastTreeValue</span></code> class, operators like <code class="docutils literal notranslate"><span class="pre">+</span></code> and methods like <code class="docutils literal notranslate"><span class="pre">map</span></code> can be used directly. Let’s see how <code class="docutils literal notranslate"><span class="pre">FastTreeValue</span></code> is defined in source code:</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">.general</span> <span class="kn">import</span> <span class="n">general_tree_value</span>


<span class="k">class</span> <span class="nc">FastTreeValue</span><span class="p">(</span><span class="n">general_tree_value</span><span class="p">()):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Overview:</span>
<span class="sd">        Fast tree value, can do almost anything with this.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>

</pre></div></td></tr></table></div>
</div>
<p>The definition is quite simple, just inherit from the return value of function <code class="docutils literal notranslate"><span class="pre">general_tree_value</span></code>, and most of the operators and methods can be used.</p>
<p>Like the <code class="docutils literal notranslate"><span class="pre">FastTreeValue</span></code> class, we can define our <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> class like the code below:</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">general_tree_value</span>


<span class="k">class</span> <span class="nc">MyTreeValue</span><span class="p">(</span><span class="n">general_tree_value</span><span class="p">()):</span>
    <span class="k">pass</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">MyTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">MyTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">47</span><span class="p">}})</span>

    <span class="c1"># __add__ operator can be directly used</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1 + t2:&#39;</span><span class="p">,</span> <span class="n">t1</span> <span class="o">+</span> <span class="n">t2</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
</pre></div></td></tr></table></div>
</div>
<p>The output should be</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span>t1 + t2:
&lt;MyTreeValue 0x7ff7de66dad0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 12
├── &#39;b&#39; --&gt; 26
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7ff7de661bd0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    └── &#39;d&#39; --&gt; 51
</pre></div></td></tr></table></div>
</div>
<p>In some cases, you can update the behaviours of some operator or methods, like the code below</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">general_tree_value</span><span class="p">,</span> <span class="n">FastTreeValue</span>


<span class="k">class</span> <span class="nc">AddZeroTreeValue</span><span class="p">(</span><span class="n">general_tree_value</span><span class="p">(</span><span class="n">methods</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
    <span class="fm">__add__</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">missing</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">),</span>
    <span class="fm">__radd__</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">missing</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">),</span>
    <span class="fm">__iadd__</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">missing</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">),</span>
<span class="p">))):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">MulOneTreeValue</span><span class="p">(</span><span class="n">general_tree_value</span><span class="p">(</span><span class="n">methods</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
    <span class="fm">__mul__</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">missing</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">),</span>
    <span class="fm">__rmul__</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">missing</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">),</span>
    <span class="fm">__imul__</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">missing</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">),</span>
<span class="p">))):</span>
    <span class="k">pass</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">FastTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">47</span><span class="p">}})</span>

    <span class="c1"># __add__ with default value 0</span>
    <span class="n">at1</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">AddZeroTreeValue</span><span class="p">)</span>
    <span class="n">at2</span> <span class="o">=</span> <span class="n">t2</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">AddZeroTreeValue</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;at1 + at2:&#39;</span><span class="p">,</span> <span class="n">at1</span> <span class="o">+</span> <span class="n">at2</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

    <span class="c1"># __mul__ with default value 1</span>
    <span class="n">mt1</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">MulOneTreeValue</span><span class="p">)</span>
    <span class="n">mt2</span> <span class="o">=</span> <span class="n">t2</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">MulOneTreeValue</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mt1 * mt2:&#39;</span><span class="p">,</span> <span class="n">mt1</span> <span class="o">*</span> <span class="n">mt2</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
</pre></div></td></tr></table></div>
</div>
<p>The output should be</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span>at1 + at2:
&lt;AddZeroTreeValue 0x7f1d7b8baad0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 12
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;AddZeroTreeValue 0x7f1d7b7bc550 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    └── &#39;d&#39; --&gt; 47

mt1 * mt2:
&lt;MulOneTreeValue 0x7f1d7b7bca50 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 11
├── &#39;b&#39; --&gt; 2
└── &#39;x&#39; --&gt; &lt;MulOneTreeValue 0x7f1d7b7b3790 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 90
    └── &#39;d&#39; --&gt; 47
</pre></div></td></tr></table></div>
</div>
<p>More than this, you can do the following things in your DIY <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> class based on function <code class="docutils literal notranslate"><span class="pre">general_tree_value</span></code>:</p>
<ul class="simple">
<li><p>change treelize arguments (like the example code above)</p></li>
<li><p>disable some operators and methods</p></li>
<li><p>change behaviour of some operators and methods</p></li>
</ul>
<p>Here is another complex demo code</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">general_tree_value</span>


<span class="k">class</span> <span class="nc">DemoTreeValue</span><span class="p">(</span><span class="n">general_tree_value</span><span class="p">(</span><span class="n">methods</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
    <span class="c1"># - operator will be disabled</span>
    <span class="fm">__sub__</span><span class="o">=</span><span class="bp">NotImplemented</span><span class="p">,</span>
    <span class="fm">__rsub__</span><span class="o">=</span><span class="bp">NotImplemented</span><span class="p">,</span>
    <span class="fm">__isub__</span><span class="o">=</span><span class="bp">NotImplemented</span><span class="p">,</span>

    <span class="c1"># / operator will raise ArithmeticError</span>
    <span class="fm">__truediv__</span><span class="o">=</span><span class="ne">ArithmeticError</span><span class="p">(</span><span class="s1">&#39;True div is not supported&#39;</span><span class="p">),</span>
    <span class="fm">__rtruediv__</span><span class="o">=</span><span class="ne">ArithmeticError</span><span class="p">(</span><span class="s1">&#39;True div is not supported&#39;</span><span class="p">),</span>
    <span class="fm">__itruediv__</span><span class="o">=</span><span class="ne">ArithmeticError</span><span class="p">(</span><span class="s1">&#39;True div is not supported&#39;</span><span class="p">),</span>

    <span class="c1"># +t will be changed to t * 2</span>
    <span class="fm">__pos__</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">))):</span>
    <span class="k">pass</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">DemoTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">DemoTreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">47</span><span class="p">}})</span>

    <span class="c1"># __add__ can be used normally</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1 + t2:&#39;</span><span class="p">,</span> <span class="n">t1</span> <span class="o">+</span> <span class="n">t2</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

    <span class="c1"># __sub__ will cause TypeError due to the NotImplemented</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">-</span> <span class="n">t2</span>
    <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1 - t2:&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;Should not reach here!&#39;</span>

    <span class="c1"># __truediv__ will cause ArithmeticError</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">/</span> <span class="n">t2</span>
    <span class="k">except</span> <span class="ne">ArithmeticError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t1 / t2:&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;Should not reach here!&#39;</span>

    <span class="c1"># __pos__ will be like t1 * 2</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;+t1:&#39;</span><span class="p">,</span> <span class="o">+</span><span class="n">t1</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
</pre></div></td></tr></table></div>
</div>
<p>The output should be</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span>t1 + t2:
&lt;DemoTreeValue 0x7f2a8e6ed9d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 12
├── &#39;b&#39; --&gt; 26
└── &#39;x&#39; --&gt; &lt;DemoTreeValue 0x7f2a8e5ddd10 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 33
    └── &#39;d&#39; --&gt; 51

t1 - t2:
unsupported operand type(s) for -: &#39;DemoTreeValue&#39; and &#39;DemoTreeValue&#39;
t1 / t2:
True div is not supported
+t1:
&lt;DemoTreeValue 0x7f2a8e5e3410 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; 2
├── &#39;b&#39; --&gt; 4
└── &#39;x&#39; --&gt; &lt;DemoTreeValue 0x7f2a8e637c90 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 6
    └── &#39;d&#39; --&gt; 8
</pre></div></td></tr></table></div>
</div>
<p>For more details about <code class="docutils literal notranslate"><span class="pre">general_tree_value</span></code>, take a look at <a class="reference internal" href="../../api_doc/tree/general.html#apidoc-tree-general-generaltreevalue"><span class="std std-ref">general_tree_value</span></a> and its source code to find out all the implemented operators and methods.</p>
</div>
<div class="section" id="diy-treevalue-utility-class">
<h2>DIY TreeValue Utility Class<a class="headerlink" href="#diy-treevalue-utility-class" title="Permalink to this headline">¶</a></h2>
<p>You can define a pure utility class in with function <code class="docutils literal notranslate"><span class="pre">utils_class</span></code> and <code class="docutils literal notranslate"><span class="pre">classmethod_treelize</span></code>. Like the following example code.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABCMeta</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="fm">__mul__</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">utils_class</span><span class="p">,</span> <span class="n">classmethod_treelize</span><span class="p">,</span> <span class="n">TreeValue</span>


<span class="k">class</span> <span class="nc">MyTreeValue</span><span class="p">(</span><span class="n">TreeValue</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="c1"># this is the utils class</span>
<span class="nd">@utils_class</span><span class="p">(</span><span class="n">return_type</span><span class="o">=</span><span class="n">MyTreeValue</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">CalcUtils</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
    <span class="c1"># return type will be detected as `MyTreeValue` as for the utils_class</span>
    <span class="nd">@classmethod</span>
    <span class="nd">@classmethod_treelize</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum arguments:&quot;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="c1"># return type will be detected as `MyTreeValue` as for the utils_class</span>
    <span class="nd">@classmethod</span>
    <span class="nd">@classmethod_treelize</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">mul</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mul arguments:&quot;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="fm">__mul__</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}})</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">}})</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CalcUtils.sum(t1, t2, t3):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">CalcUtils</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CalcUtils.mul(t1, t2, t3):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">CalcUtils</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">))</span>
</pre></div></td></tr></table></div>
</div>
<p>The result should be like below.</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span>CalcUtils.sum(t1, t2, t3):
Sum arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 1 -14 6
Sum arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 2 9 0
Sum arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 3 3 -5
Sum arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 4 8 17
&lt;MyTreeValue 0x7f7847fdd9d0 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; -7
├── &#39;b&#39; --&gt; 11
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7f7847f2fad0 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; 1
    └── &#39;d&#39; --&gt; 29

CalcUtils.mul(t1, t2, t3):
Mul arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 1 -14 6
Mul arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 2 9 0
Mul arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 3 3 -5
Mul arguments: &lt;class &#39;__main__.CalcUtils&#39;&gt; 4 8 17
&lt;MyTreeValue 0x7f7847f28990 keys: [&#39;a&#39;, &#39;b&#39;, &#39;x&#39;]&gt;
├── &#39;a&#39; --&gt; -84
├── &#39;b&#39; --&gt; 0
└── &#39;x&#39; --&gt; &lt;MyTreeValue 0x7f7847ec5b50 keys: [&#39;c&#39;, &#39;d&#39;]&gt;
    ├── &#39;c&#39; --&gt; -45
    └── &#39;d&#39; --&gt; 544
</pre></div></td></tr></table></div>
</div>
<p>For further information of function <code class="docutils literal notranslate"><span class="pre">utils_class</span></code> and <code class="docutils literal notranslate"><span class="pre">classmethod_treelize</span></code>, just take a look at:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../api_doc/tree/func.html#apidoc-tree-func-utilsclass"><span class="std std-ref">utils_class</span></a></p></li>
<li><p><a class="reference internal" href="../../api_doc/tree/func.html#apidoc-tree-func-classmethodtreelize"><span class="std std-ref">classmethod_treelize</span></a></p></li>
</ul>
</div>
<div class="section" id="draw-graph-for-treevalue">
<h2>Draw Graph For TreeValue<a class="headerlink" href="#draw-graph-for-treevalue" title="Permalink to this headline">¶</a></h2>
<p>You can easily draw a graph of the <code class="docutils literal notranslate"><span class="pre">TreeValue</span></code> objects with function <code class="docutils literal notranslate"><span class="pre">graphics</span></code>. Like the following example code.</p>
<div class="highlight-python notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">treevalue</span> <span class="kn">import</span> <span class="n">FastTreeValue</span><span class="p">,</span> <span class="n">graphics</span><span class="p">,</span> <span class="n">TreeValue</span>


<span class="k">class</span> <span class="nc">MyFastTreeValue</span><span class="p">(</span><span class="n">FastTreeValue</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">MyFastTreeValue</span><span class="p">({</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]),</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
        <span class="p">},</span>
    <span class="p">})</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">TreeValue</span><span class="p">({</span><span class="s1">&#39;ppp&#39;</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">x</span><span class="p">}})</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">graphics</span><span class="p">(</span>
        <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="s1">&#39;t2&#39;</span><span class="p">),</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;This is a demo of 2 trees.&quot;</span><span class="p">,</span>
        <span class="n">cfg</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;bgcolor&#39;</span><span class="p">:</span> <span class="s1">&#39;#ffffff00&#39;</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s1">&#39;graphics.dat.gv&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
</pre></div></td></tr></table></div>
</div>
<p>The generated code and graph should be like below ( name of the image file should be <code class="docutils literal notranslate"><span class="pre">graphics.dat.gv.svg</span></code>, name of the graphviz source code file should be <code class="docutils literal notranslate"><span class="pre">graphics.dat.gv</span></code> ).</p>
<div class="highlight-text notranslate"><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span>// This is a demo of 2 trees.
digraph this_is_a_demo_of_2_trees {
	graph [bgcolor=&quot;#ffffff00&quot; label=&quot;This is a demo of 2 trees.&quot;]
	node_7f156b39d110 [label=t color=&quot;#3eb24899&quot; fillcolor=&quot;#73ff7e99&quot; fontcolor=&quot;#003304ff&quot; fontname=&quot;Times-Roman bold&quot; penwidth=3 shape=diamond style=filled]
	node_7f15631156d0 [label=t2 color=&quot;#5b3eb299&quot; fillcolor=&quot;#9673ff99&quot; fontcolor=&quot;#0d0033ff&quot; fontname=&quot;Times-Roman bold&quot; penwidth=3 shape=diamond style=filled]
	value__node_7f156b39d110__a [label=1 color=&quot;#3eb24800&quot; fillcolor=&quot;#73ff7e99&quot; fontcolor=&quot;#003304ff&quot; fontname=&quot;Times-Roman&quot; penwidth=1.5 shape=box style=filled]
	node_7f156b39d110 -&gt; value__node_7f156b39d110__a [label=a arrowhead=dot arrowsize=0.5 color=&quot;#1f9929cc&quot; fontcolor=&quot;#00730aff&quot; fontname=&quot;Times-Roman bold&quot;]
	value__node_7f156b39d110__b [label=&quot;array([[5, 6],
       [7, 8]])&quot; color=&quot;#3eb24800&quot; fillcolor=&quot;#73ff7e99&quot; fontcolor=&quot;#003304ff&quot; fontname=&quot;Times-Roman&quot; penwidth=1.5 shape=box style=filled]
	node_7f156b39d110 -&gt; value__node_7f156b39d110__b [label=b arrowhead=dot arrowsize=0.5 color=&quot;#1f9929cc&quot; fontcolor=&quot;#00730aff&quot; fontname=&quot;Times-Roman bold&quot;]
	node_7f15631b7090 [label=&quot;t.x&quot; color=&quot;#3eb24899&quot; fillcolor=&quot;#73ff7e99&quot; fontcolor=&quot;#003304ff&quot; fontname=&quot;Times-Roman bold&quot; penwidth=1.5 shape=ellipse style=filled]
	node_7f156b39d110 -&gt; node_7f15631b7090 [label=x arrowhead=vee arrowsize=1.0 color=&quot;#1f9929cc&quot; fontcolor=&quot;#00730aff&quot; fontname=&quot;Times-Roman bold&quot;]
	node_7f15631156d0 -&gt; node_7f15631b7090 [label=ppp arrowhead=vee arrowsize=1.0 color=&quot;#3d1f99cc&quot; fontcolor=&quot;#1d0073ff&quot; fontname=&quot;Times-Roman bold&quot;]
	node_7f156b394c90 [label=&quot;t2.x&quot; color=&quot;#5b3eb299&quot; fillcolor=&quot;#9673ff99&quot; fontcolor=&quot;#0d0033ff&quot; fontname=&quot;Times-Roman bold&quot; penwidth=1.5 shape=ellipse style=filled]
	node_7f15631156d0 -&gt; node_7f156b394c90 [label=x arrowhead=vee arrowsize=1.0 color=&quot;#3d1f99cc&quot; fontcolor=&quot;#1d0073ff&quot; fontname=&quot;Times-Roman bold&quot;]
	value__node_7f15631b7090__c [label=3 color=&quot;#3eb24800&quot; fillcolor=&quot;#73ff7e99&quot; fontcolor=&quot;#003304ff&quot; fontname=&quot;Times-Roman&quot; penwidth=1.5 shape=box style=filled]
	node_7f15631b7090 -&gt; value__node_7f15631b7090__c [label=c arrowhead=dot arrowsize=0.5 color=&quot;#1f9929cc&quot; fontcolor=&quot;#00730aff&quot; fontname=&quot;Times-Roman bold&quot;]
	value__node_7f15631b7090__d [label=4 color=&quot;#3eb24800&quot; fillcolor=&quot;#73ff7e99&quot; fontcolor=&quot;#003304ff&quot; fontname=&quot;Times-Roman&quot; penwidth=1.5 shape=box style=filled]
	node_7f15631b7090 -&gt; value__node_7f15631b7090__d [label=d arrowhead=dot arrowsize=0.5 color=&quot;#1f9929cc&quot; fontcolor=&quot;#00730aff&quot; fontname=&quot;Times-Roman bold&quot;]
	value__node_7f15631b7090__e [label=&quot;array([[1, 2],
       [3, 4]])&quot; color=&quot;#3eb24800&quot; fillcolor=&quot;#73ff7e99&quot; fontcolor=&quot;#003304ff&quot; fontname=&quot;Times-Roman&quot; penwidth=1.5 shape=box style=filled]
	node_7f15631b7090 -&gt; value__node_7f15631b7090__e [label=e arrowhead=dot arrowsize=0.5 color=&quot;#1f9929cc&quot; fontcolor=&quot;#00730aff&quot; fontname=&quot;Times-Roman bold&quot;]
	node_7f156b394c90 -&gt; node_7f156b39d110 [label=t arrowhead=vee arrowsize=1.0 color=&quot;#3d1f99cc&quot; fontcolor=&quot;#1d0073ff&quot; fontname=&quot;Times-Roman bold&quot;]
	node_7f156b394c90 -&gt; node_7f15631b7090 [label=y arrowhead=vee arrowsize=1.0 color=&quot;#3d1f99cc&quot; fontcolor=&quot;#1d0073ff&quot; fontname=&quot;Times-Roman bold&quot;]
}
</pre></div></td></tr></table></div>
</div>
<img alt="../../_images/graphics.dat.gv1.svg" class="align-center" src="../../_images/graphics.dat.gv1.svg" /><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The return value’s type of function <code class="docutils literal notranslate"><span class="pre">graphics</span></code> is class <code class="docutils literal notranslate"><span class="pre">graphviz.dot.Digraph</span></code>, from the opensource library <code class="docutils literal notranslate"><span class="pre">graphviz</span></code>, for further information of this project and <code class="docutils literal notranslate"><span class="pre">graphviz.dot.Digraph</span></code>’s usage, take a look at:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://graphviz.org/">Official site of Graphviz</a>.</p></li>
<li><p><a class="reference external" href="https://graphviz.readthedocs.io/en/stable/manual.html#formats">User Guide of Graphviz</a>.</p></li>
<li><p><a class="reference external" href="https://graphviz.readthedocs.io/en/stable/api.html">API Reference of Graphviz</a>.</p></li>
</ul>
</div>
<p>For further information of function <code class="docutils literal notranslate"><span class="pre">graphics</span></code>, just take a look at</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../api_doc/tree/tree.html#apidoc-tree-tree-graphics"><span class="std std-ref">graphics</span></a>.</p></li>
</ul>
</div>
</div>



           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../cli_usage/index.html" class="btn btn-neutral float-right" title="CLI Usage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../basic_usage/index.html" class="btn btn-neutral float-left" title="Basic Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, HansBug, DI-engine&#39;s Contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: v0.1.0
    <span class="fa fa-caret-down"></span>
  </span>
        <div class="rst-other-versions">
                <dl>
                    <dt>Tags</dt>
                        <dd><a href="../../../v0.0.1/tutorials/advanced_usage/index.html">v0.0.1</a></dd>
                        <dd><a href="index.html">v0.1.0</a></dd>
                        <dd><a href="../../../v1.0.0/tutorials/advanced_usage/index.html">v1.0.0</a></dd>
                        <dd><a href="../../../v1.1.0/tutorials/advanced_usage/index.html">v1.1.0</a></dd>
                        <dd><a href="../../../v1.2.0/tutorials/advanced_usage/index.html">v1.2.0</a></dd>
                        <dd><a href="../../../v1.2.1/tutorials/advanced_usage/index.html">v1.2.1</a></dd>
                        <dd><a href="../../../v1.2.2/tutorials/advanced_usage/index.html">v1.2.2</a></dd>
                        <dd><a href="../../../v1.3.0/tutorials/advanced_usage/index.html">v1.3.0</a></dd>
                </dl>
                <dl>
                    <dt>Branches</dt>
                        <dd><a href="../../../main/tutorials/advanced_usage/index.html">main</a></dd>
                        <dd><a href="../../../dev/pop/tutorials/advanced_usage/index.html">dev/pop</a></dd>
                        <dd><a href="../../../refactor/color/tutorials/advanced_usage/index.html">refactor/color</a></dd>
                        <dd><a href="../../../run/paper/tutorials/advanced_usage/index.html">run/paper</a></dd>
                </dl>
        </div>
    </div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>